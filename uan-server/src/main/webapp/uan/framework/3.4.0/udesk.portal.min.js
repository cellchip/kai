!function(e){function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,s){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var i=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t){e.exports=jQuery},,,,,function(e,t,i){i(6),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(17),e.exports=i(18)},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t){var i=t,s=i.options,n=i.$dialog;n.on("show.bs.modal",function(){i.isShown=!0,e.isFunction(s.onShow)&&s.onShow(n)}),n.on("shown.bs.modal",function(){i.isShown=!0,e.isFunction(s.onShown)&&s.onShown(n)}),n.on("hide.bs.modal",function(){i.isShown=!0,e.isFunction(s.onHide)&&s.onHide(n)}),n.on("hidden.bs.modal",function(){i.isShown=!1,e.isFunction(s.onHidden)&&s.onHidden(n),s.emptyOnHidden&&i.$wrapper.empty()}),n.on("click",'button[id^="choiceBtn"]',function(t){e.isFunction(i.confirmCallback)&&i.confirmCallback(e(t.target).data("code"))})}var a={wrapper:'<div class="udeskModal"></div>',backdrop:!0,keyboard:!0,remote:!1,emptyOnHidden:!0,onInit:function(e){},onShow:function(e){},onShown:function(e){},onHide:function(e){},onHidden:function(e){},confirmChoice:[{display:"是(Y)",code:"YES"},{display:"否(N)",code:"NO"}],defaultChoice:0,templates:[{type:"confirm",template:'{{var data = it;}}<div class="modal fade confirm-modal" tabindex="-1" role="dialog" aria-labelledby="udeskModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title"><i class="{{if(data.icon){ }} {{=data.icon}} {{ }else{ }}fa fa-exclamation{{ } }}"></i><b>{{if(data.title){ }} {{=data.title}} {{ }else{ }} 操作确认 {{ } }}</b></h4></div><div class="modal-body">{{if(data.message){ }}<div class="message">{{=data.message}}</div>{{ }else{ }}确定要执行操作吗？{{ } }}{{if(data.detail) { }}<div class="detail"> {{=data.detail }}</div>{{ } }}</div><div class="modal-footer">{{var choice = data.choice; for(var i=0; i<choice.length; i++){ }}{{if( data.defaultChoice == i ){ }}<button type="button" class="btn active btn-theme" data-dismiss="modal" data-code="{{=choice[i].code}}" id="choiceBtn{{=choice[i].code}}">{{=choice[i].display}}</button>{{ }else{ }}<button type="button" class="btn" data-dismiss="modal" data-code="{{=choice[i].code}}" id="choiceBtn{{=choice[i].code}}">{{=choice[i].display}}</button>{{ } }}{{ } }}</div></div></div></div>'},{type:"messageDetail",template:'{{var data = it;}} <div class="modal fade error-modal" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title"><i class="{{if(data.icon){ }} {{=data.icon}} {{ }else{ }}fa fa-envelope-o{{ } }}"></i><b>{{if(data.title){ }} {{=data.title}} {{ }else{ }} 详细通知 {{ } }}</b></h4></div><div class="modal-body">{{if(data.message){ }}<div class="message">{{=data.message}}</div>{{ } }}{{if(data.detail) { }}<div class="detail"> {{=data.detail }}</div>{{ } }}</div><div class="modal-footer"><button type="button" class="btn btn-theme" data-dismiss="modal">关闭</button></div></div></div></div>'},{type:"messageBox",template:'{{var data = it;}}<div class="modal fade error-modal" tabindex="-1" role="dialog" aria-labelledby="u-modal-label" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title"><i class="{{if(data.icon){ }} {{=data.icon}} {{ }else{ }}fa fa-envelope-o{{ } }}"></i><b>{{if(data.title){ }} {{=data.title}} {{ }else{ }} 消息 {{ } }}</b></h4></div><div class="modal-body">{{if(data.message){ }}<div class="message">{{=data.message}}</div>{{ } }}</div><div class="modal-footer"><button type="button" class="btn" data-dismiss="modal">关闭</button></div></div></div></div>'}]},o=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,o.prototype,{constructor:o,VERSION:"3.4.0",$wrapper:s,$dialog:s,isShown:!1,confirmCallback:function(e){},init:function(){var t=this.options;return this.$wrapper=e(t.wrapper).appendTo(this.$element),this},show:function(t,i){if(this.isShown)return this;var a=this.options,o=a.templates,r=s;for(var d in o)if(o[d].type==i){r=udesk.template(o[d].template)(t);break}s==r&&(r=udesk.template(o[o.length-1].template)(t));var l=e.extend(!0,{},a,{backdrop:t.backdrop,keyboard:t.keyboard});return this.$dialog=this.$wrapper.append(r).children().last(),this.$dialog.modal(l),n(this),e.isFunction(a.onInit)&&a.onInit(this),this.$dialog.modal("show"),this},messageBox:function(e,t){return this.show(e,t||"messageBox")},confirm:function(e){var t=this.options;return this.confirmCallback=e.confirmCallback,e.choice&&e.choice.length||(e.choice=t.confirmChoice),e.defaultChoice!=s&&null!=e.defaultChoice||(e.defaultChoice=t.defaultChoice),this.show(e,"confirm")},messageDetail:function(e){return this.show(e,"messageDetail"),this},hide:function(){return this.isShown?(this.dialog&&this.dialog.modal("hide"),this):this},toggle:function(){return this.dialog&&this.dialog.modal("toggle"),this}}),e.fn.udeskModal=function(t){var i=e.extend(!0,{},e.fn.udeskModal.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskModal")||t.data("udeskModal",new e.fn.udeskModal.constructor(t,i))})},e.fn.udeskModal.defaults=a,e.fn.udeskModal.constructor=o})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t){var i=t,s=i.options,n=s.selector;return i.notice.options.appendTo.on("click",".message-detail a",function(){var t;switch(e(this).data("type")){case"success":t=s.detailIcon.success;break;case"warning":t=s.detailIcon.warning;break;case"error":t=s.detailIcon.error;break;case"info":t=s.detailIcon.info;break;default:t=null}udesk&&udesk.messageDetail({title:e(this).parent().siblings("h4").text(),icon:t,message:e(this).parent().siblings(n.messageBrief).text(),detail:e(this).siblings(n.hiddenDetail).text()})}),i.notice.options.appendTo.on("click",".notice-close",function(){e(this).closest(".k-notification").fadeOut(s.animation.close.duration,function(){e(this).remove()})}),i}var a={target:'<div class="notice-handler" style="display:none;"></div>',displayZone:'<div class="notice-display-zone"></div>',name:"Notification",position:{pinned:!0,top:30,right:30},stacking:"down",hideOnClick:!1,button:!0,allowHideAfter:0,autoHideAfter:0,appendTo:null,width:null,height:null,templates:[{type:"success",template:'<div class="u-notice"><div class="notice-image"></div><div class="notice-message"><h4><b>成功</b></h4>#if(message){#<p class="message-brief"><a class="tip" #if(message.length > 19){#title="#=message#"#}#>#=message#</a></p>#}##if(detail && detail.length > 19){#<p class="message-detail"><a data-type="success">点击查看详细信息<i class="fa fa-ellipsis-h"></i></a><span class="hidden">#=detail#</span></p> #} else if(detail) {# <p class="message-detail">#=detail#</p>#}#</div><a class="notice-close fa fa-remove"></a></div>'},{type:"warning",template:'<div class="u-notice"><div class="notice-image"></div><div class="notice-message"><h4><b>警告</b></h4>#if(message){#<p class="message-brief"><a class="tip" #if(message.length > 19){#title="#=message#"#}#>#=message#</a></p>#}##if(detail && detail.length > 19){#<p class="message-detail"><a data-type="warning">点击查看详细信息<i class="fa fa-ellipsis-h"></i></a><span class="hidden">#=detail#</span></p> #} else if(detail) {# <p class="message-detail">#=detail#</p>#}#</div><a class="notice-close fa fa-remove"></a></div>'},{type:"error",template:'<div class="u-notice"><div class="notice-image"></div><div class="notice-message"><h4><b>失败</b></h4>#if(message){#<p class="message-brief"><a class="tip" #if(message.length > 19){#title="#=message#"#}#>#=message#</a></p>#}##if(detail && detail.length > 19){#<p class="message-detail"><a data-type="error">点击查看详细信息<i class="fa fa-ellipsis-h"></i></a><span class="hidden">#=detail#</span></p> #} else if(detail) {# <p class="message-detail">#=detail#</p>#}#</div><a class="notice-close fa fa-remove"></a></div>'},{type:"info",template:'<div class="u-notice"><div class="notice-image"></div><div class="notice-message"><div><h4><b>通知</b></h4>#if(message){#<p class="message-brief"><a class="tip" #if(message.length > 19){#title="#=message#"#}#>#=message#</a></p>#}##if(detail && detail.length > 19){#<p class="message-detail"><a data-type="info">点击查看详细信息<i class="fa fa-ellipsis-h"></i></a><span class="hidden">#=detail#</span></p> #} else if(detail) {# <p class="message-detail">#=detail#</p>#}#</div><a class="notice-close fa fa-remove"></a></div>'}],animation:{open:{effects:"fade:in",duration:300},close:{effects:"fade:out",duration:600,hide:!0}},selector:{hiddenDetail:".hidden",messageBrief:".message-brief",messageDetail:".message-detail"},detailIcon:{success:"fa fa-check",warning:"fa fa-exclamation",error:"fa fa-remove",info:"fa fa-envelope-o"},onShow:function(e){},onHide:function(e){},draggable:{filter:">div",axis:"y",hint:function(e){return e.clone()}}},o=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(o.prototype,{constructor:o,VERSION:"3.4.0",notice:s,sortable:s,init:function(){var t=this.options,i=e.extend(!0,{},t,{show:t.onShow,hide:t.onHide,appendTo:e(t.displayZone).appendTo(this.$element)}),s=e.extend(!0,{},t.draggable,{container:i.appendTo});try{this.notice=e(t.target).appendTo(this.$element).kendoNotification(i).data("kendoNotification"),this.sortable=i.appendTo.kendoSortable(s).data("kendoSortable")}catch(t){return console.log(t),null}return n(this),this},show:function(e,t){return this.notice.show(e,t),this},hideAll:function(){return this.notice.hide(),this}}),e.fn.udeskNotice=function(t){var i=e.extend(!0,{},e.fn.udeskNotice.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskNotice")||t.data("udeskNotice",new e.fn.udeskNotice.constructor(t,i))})},e.fn.udeskNotice.defaults=a,e.fn.udeskNotice.constructor=o})},function(e,t,i){var s,n,a,s,n,o,s,n,r,n,s,d,s,d;!function(e,o){s=[i(0)],n=o,a="function"==typeof n?n.apply(t,s):n}(0,function(e){function t(t){return t[0]&&e.isPlainObject(t[0])?this.data=t[0]:this.el=t,this.isCoords=!0,this.coords={},this.init(),this}var i=t.prototype;return i.init=function(){this.set(),this.original_coords=this.get()},i.set=function(e,t){var i=this.el;if(i&&!e&&(this.data=i.offset(),this.data.width=i.width(),this.data.height=i.height()),i&&e&&!t){var s=i.offset();this.data.top=s.top,this.data.left=s.left}var n=this.data;return void 0===n.left&&(n.left=n.x1),void 0===n.top&&(n.top=n.y1),this.coords.x1=n.left,this.coords.y1=n.top,this.coords.x2=n.left+n.width,this.coords.y2=n.top+n.height,this.coords.cx=n.left+n.width/2,this.coords.cy=n.top+n.height/2,this.coords.width=n.width,this.coords.height=n.height,this.coords.el=i||!1,this},i.update=function(t){if(!t&&!this.el)return this;if(t){var i=e.extend({},this.data,t);return this.data=i,this.set(!0,!0)}return this.set(!0),this},i.get=function(){return this.coords},i.destroy=function(){this.el.removeData("coords"),delete this.el},e.fn.coords=function(){if(this.data("coords"))return this.data("coords");var e=new t(this,arguments[0]);return this.data("coords",e),e},t}),function(e,r){s=[i(0),a],n=r,o="function"==typeof n?n.apply(t,s):n}(0,function(e,t){function i(t,i,n){this.options=e.extend(s,n),this.$element=t,this.last_colliders=[],this.last_colliders_coords=[],this.set_colliders(i),this.init()}var s={colliders_context:document.body,overlapping_region:"C"};i.defaults=s;var n=i.prototype;return n.init=function(){this.find_collisions()},n.overlaps=function(e,t){var i=!1,s=!1;return(t.x1>=e.x1&&t.x1<=e.x2||t.x2>=e.x1&&t.x2<=e.x2||e.x1>=t.x1&&e.x2<=t.x2)&&(i=!0),(t.y1>=e.y1&&t.y1<=e.y2||t.y2>=e.y1&&t.y2<=e.y2||e.y1>=t.y1&&e.y2<=t.y2)&&(s=!0),i&&s},n.detect_overlapping_region=function(e,t){var i="",s="";return e.y1>t.cy&&e.y1<t.y2&&(i="N"),e.y2>t.y1&&e.y2<t.cy&&(i="S"),e.x1>t.cx&&e.x1<t.x2&&(s="W"),e.x2>t.x1&&e.x2<t.cx&&(s="E"),i+s||"C"},n.calculate_overlapped_area_coords=function(t,i){var s=Math.max(t.x1,i.x1),n=Math.max(t.y1,i.y1),a=Math.min(t.x2,i.x2),o=Math.min(t.y2,i.y2);return e({left:s,top:n,width:a-s,height:o-n}).coords().get()},n.calculate_overlapped_area=function(e){return e.width*e.height},n.manage_colliders_start_stop=function(t,i,s){for(var n=this.last_colliders_coords,a=0,o=n.length;a<o;a++)-1===e.inArray(n[a],t)&&i.call(this,n[a]);for(var r=0,d=t.length;r<d;r++)-1===e.inArray(t[r],n)&&s.call(this,t[r])},n.find_collisions=function(t){for(var i=this,s=this.options.overlapping_region,n=[],a=[],o=this.colliders||this.$colliders,r=o.length,d=i.$element.coords().update(t||!1).get();r--;){var l=i.$colliders?e(o[r]):o[r],c=l.isCoords?l:l.coords(),u=c.get();if(i.overlaps(d,u)){var h=i.detect_overlapping_region(d,u);if(h===s||"all"===s){var p=i.calculate_overlapped_area_coords(d,u),f=i.calculate_overlapped_area(p),_={area:f,area_coords:p,region:h,coords:u,player_coords:d,el:l};i.options.on_overlap&&i.options.on_overlap.call(this,_),n.push(c),a.push(_)}}}return(i.options.on_overlap_stop||i.options.on_overlap_start)&&this.manage_colliders_start_stop(n,i.options.on_overlap_start,i.options.on_overlap_stop),this.last_colliders_coords=n,a},n.get_closest_colliders=function(e){var t=this.find_collisions(e);return t.sort(function(e,t){return"C"===e.region&&"C"===t.region?e.coords.y1<t.coords.y1||e.coords.x1<t.coords.x1?-1:1:(e.area,t.area,1)}),t},n.set_colliders=function(t){"string"==typeof t||t instanceof e?this.$colliders=e(t,this.options.colliders_context).not(this.$element):this.colliders=e(t)},e.fn.collision=function(e,t){return new i(this,e,t)},i}),function(e,t){e.delay=function(e,t){var i=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},e.debounce=function(e,t,i){var s;return function(){var n=this,a=arguments,o=function(){s=null,i||e.apply(n,a)};i&&!s&&e.apply(n,a),clearTimeout(s),s=setTimeout(o,t)}},e.throttle=function(e,t){var i,s,n,a,o,r,d=debounce(function(){o=a=!1},t);return function(){i=this,s=arguments;var l=function(){n=null,o&&e.apply(i,s),d()};return n||(n=setTimeout(l,t)),a?o=!0:r=e.apply(i,s),d(),a=!0,r}}}(window),function(e,a){s=[i(0)],n=a,r="function"==typeof n?n.apply(t,s):n}(0,function(e){function t(t,s){this.options=e.extend({},i,s),this.$document=e(document),this.$container=e(t),this.$dragitems=e(this.options.items,this.$container),this.is_dragging=!1,this.player_min_left=0+this.options.offset_left,this.id=d(),this.ns=".gridster-draggable-"+this.id,this.init()}var i={items:"li",distance:1,limit:!0,offset_left:0,autoscroll:!0,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null,container_width:0,move_element:!0,helper:!1,remove_helper:!0},s=e(window),n={x:"left",y:"top"},a=!!("ontouchstart"in window),o=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},r=0,d=function(){return++r+""};t.defaults=i;var l=t.prototype;return l.init=function(){var t=this.$container.css("position");this.calculate_dimensions(),this.$container.css("position","static"===t?"relative":t),this.disabled=!1,this.events(),e(window).bind(this.nsEvent("resize"),throttle(e.proxy(this.calculate_dimensions,this),200))},l.nsEvent=function(e){return(e||"")+this.ns},l.events=function(){this.pointer_events={start:this.nsEvent("touchstart")+" "+this.nsEvent("mousedown"),move:this.nsEvent("touchmove")+" "+this.nsEvent("mousemove"),end:this.nsEvent("touchend")+" "+this.nsEvent("mouseup")},this.$container.on(this.nsEvent("selectstart"),e.proxy(this.on_select_start,this)),this.$container.on(this.pointer_events.start,this.options.items,e.proxy(this.drag_handler,this)),this.$document.on(this.pointer_events.end,e.proxy(function(e){this.is_dragging=!1,this.disabled||(this.$document.off(this.pointer_events.move),this.drag_start&&this.on_dragstop(e))},this))},l.get_actual_pos=function(e){return e.position()},l.get_mouse_pos=function(e){if(e.originalEvent&&e.originalEvent.touches){var t=e.originalEvent;e=t.touches.length?t.touches[0]:t.changedTouches[0]}return{left:e.clientX,top:e.clientY}},l.get_offset=function(t){t.preventDefault();var i=this.get_mouse_pos(t),s=Math.round(i.left-this.mouse_init_pos.left),n=Math.round(i.top-this.mouse_init_pos.top),a=Math.round(this.el_init_offset.left+s-this.baseX+e(window).scrollLeft()-this.win_offset_x),o=Math.round(this.el_init_offset.top+n-this.baseY+e(window).scrollTop()-this.win_offset_y);return this.options.limit&&(a>this.player_max_left?a=this.player_max_left:a<this.player_min_left&&(a=this.player_min_left)),{position:{left:a,top:o},pointer:{left:i.left,top:i.top,diff_left:s+(e(window).scrollLeft()-this.win_offset_x),diff_top:n+(e(window).scrollTop()-this.win_offset_y)}}},l.get_drag_data=function(e){var t=this.get_offset(e);return t.$player=this.$player,t.$helper=this.helper?this.$helper:this.$player,t},l.set_limits=function(e){return e||(e=this.$container.width()),this.player_max_left=e-this.player_width-this.options.offset_left,this.options.container_width=e,this},l.scroll_in=function(t,i){var a,r=n[t],d="x"===t,l=d?this.window_width:this.window_height,c=d?e(document).width():e(document).height(),u=d?this.$player.width():this.$player.height(),h=s["scroll"+o(r)](),p=h,f=p+l,_=f-50,m=p+50,g=p+i.pointer[r],v=c-l+u;return g>=_&&(a=h+30)<v&&(s["scroll"+o(r)](a),this["scroll_offset_"+t]+=30),g<=m&&(a=h-30)>0&&(s["scroll"+o(r)](a),this["scroll_offset_"+t]-=30),this},l.manage_scroll=function(e){this.scroll_in("x",e),this.scroll_in("y",e)},l.calculate_dimensions=function(e){this.window_height=s.height(),this.window_width=s.width()},l.drag_handler=function(t){if(t.target.nodeName,!this.disabled&&(1===t.which||a)&&!this.ignore_drag(t)){var i=this,s=!0;return this.$player=e(t.currentTarget),this.el_init_pos=this.get_actual_pos(this.$player),this.mouse_init_pos=this.get_mouse_pos(t),this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top,this.$document.on(this.pointer_events.move,function(e){var t=i.get_mouse_pos(e),n=Math.abs(t.left-i.mouse_init_pos.left),a=Math.abs(t.top-i.mouse_init_pos.top);return(n>i.options.distance||a>i.options.distance)&&(s?(s=!1,i.on_dragstart.call(i,e),!1):(!0===i.is_dragging&&i.on_dragmove.call(i,e),!1))}),!!a&&void 0}},l.on_dragstart=function(t){if(t.preventDefault(),this.is_dragging)return this;this.drag_start=this.is_dragging=!0;var i=this.$container.offset();return this.baseX=Math.round(i.left),this.baseY=Math.round(i.top),this.initial_container_width=this.options.container_width||this.$container.width(),"clone"===this.options.helper?(this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper"),this.helper=!0):this.helper=!1,this.win_offset_y=e(window).scrollTop(),this.win_offset_x=e(window).scrollLeft(),this.scroll_offset_y=0,this.scroll_offset_x=0,this.el_init_offset=this.$player.offset(),this.player_width=this.$player.width(),this.player_height=this.$player.height(),this.set_limits(this.options.container_width),this.options.start&&this.options.start.call(this.$player,t,this.get_drag_data(t)),!1},l.on_dragmove=function(e){var t=this.get_drag_data(e);this.options.autoscroll&&this.manage_scroll(t),this.options.move_element&&(this.helper?this.$helper:this.$player).css({position:"absolute",left:t.position.left,top:t.position.top});var i=this.last_position||t.position;return t.prev_position=i,this.options.drag&&this.options.drag.call(this.$player,e,t),this.last_position=t.position,!1},l.on_dragstop=function(e){var t=this.get_drag_data(e);return this.drag_start=!1,this.options.stop&&this.options.stop.call(this.$player,e,t),this.helper&&this.options.remove_helper&&this.$helper.remove(),!1},l.on_select_start=function(e){if(!this.disabled&&!this.ignore_drag(e))return!1},l.enable=function(){this.disabled=!1},l.disable=function(){this.disabled=!0},l.destroy=function(){this.disable(),this.$container.off(this.ns),this.$document.off(this.ns),e(window).off(this.ns),e.removeData(this.$container,"drag")},l.ignore_drag=function(t){return this.options.handle?!e(t.target).is(this.options.handle):e.isFunction(this.options.ignore_dragging)?this.options.ignore_dragging(t):e(t.target).is(this.options.ignore_dragging.join(", "))},e.fn.drag=function(e){return new t(this,e)},t}),function(a,l){s=[i(0),r,o],n=l,void 0!==(d="function"==typeof n?n.apply(t,s):n)&&(e.exports=d)}(0,function(e,t,i){function s(t,i){this.options=e.extend(!0,{},n,i),this.$el=e(t),this.$wrapper=this.$el.parent(),this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs-w"),this.widgets=[],this.$changed=e([]),this.wrapper_width=this.$wrapper.width(),this.min_widget_width=2*this.options.widget_margins[0]+this.options.widget_base_dimensions[0],this.min_widget_height=2*this.options.widget_margins[1]+this.options.widget_base_dimensions[1],this.generated_stylesheets=[],this.$style_tags=e([]),this.options.auto_init&&this.init()}var n={namespace:"",widget_selector:"li",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,max_cols:1/0,min_rows:15,max_size_x:!1,autogrow_cols:!1,autogenerate_stylesheet:!0,avoid_overlapped_widgets:!0,auto_init:!0,serialize_params:function(e,t){return{col:t.col,row:t.row,size_x:t.size_x,size_y:t.size_y}},collision:{},draggable:{items:".gs-w",distance:4,ignore_dragging:t.defaults.ignore_dragging.slice(0)},resize:{enabled:!1,axes:["both"],handle_append_to:"",handle_class:"gs-resize-handle",max_size:[1/0,1/0],min_size:[1,1]}};s.defaults=n,s.generated_stylesheets=[],s.sort_by_row_asc=function(t){return t=t.sort(function(t,i){return t.row||(t=e(t).coords().grid,i=e(i).coords().grid),t.row>i.row?1:-1})},s.sort_by_row_and_col_asc=function(e){return e=e.sort(function(e,t){return e.row>t.row||e.row===t.row&&e.col>t.col?1:-1})},s.sort_by_col_asc=function(e){return e=e.sort(function(e,t){return e.col>t.col?1:-1})},s.sort_by_row_desc=function(e){return e=e.sort(function(e,t){return e.row+e.size_y<t.row+t.size_y?1:-1})};var a=s.prototype;return a.init=function(){this.options.resize.enabled&&this.setup_resize(),this.generate_grid_and_stylesheet(),this.get_widgets_from_DOM(),this.set_dom_grid_height(),this.set_dom_grid_width(),this.$wrapper.addClass("ready"),this.draggable(),this.options.resize.enabled&&this.resizable(),e(window).bind("resize.gridster",throttle(e.proxy(this.recalculate_faux_grid,this),200))},a.disable=function(){return this.$wrapper.find(".player-revert").removeClass("player-revert"),this.drag_api.disable(),this},a.enable=function(){return this.drag_api.enable(),this},a.disable_resize=function(){return this.$el.addClass("gs-resize-disabled"),this.resize_api.disable(),this},a.enable_resize=function(){return this.$el.removeClass("gs-resize-disabled"),this.resize_api.enable(),this},a.add_widget=function(t,i,s,n,a,o,r){var d;i||(i=1),s||(s=1),!n&!a?d=this.next_position(i,s):(d={col:n,row:a,size_x:i,size_y:s},this.empty_cells(n,a,i,s));var l=e(t).attr({"data-col":d.col,"data-row":d.row,"data-sizex":i,"data-sizey":s}).addClass("gs-w").appendTo(this.$el).hide();return this.$widgets=this.$widgets.add(l),this.register_widget(l),this.add_faux_rows(d.size_y),o&&this.set_widget_max_size(l,o),r&&this.set_widget_min_size(l,r),this.set_dom_grid_width(),this.set_dom_grid_height(),this.drag_api.set_limits(this.cols*this.min_widget_width),l.fadeIn()},a.set_widget_min_size=function(e,t){if(e="number"==typeof e?this.$widgets.eq(e):e,!e.length)return this;var i=e.data("coords").grid;return i.min_size_x=t[0],i.min_size_y=t[1],this},a.set_widget_max_size=function(e,t){if(e="number"==typeof e?this.$widgets.eq(e):e,!e.length)return this;var i=e.data("coords").grid;return i.max_size_x=t[0],i.max_size_y=t[1],this},a.add_resize_handle=function(t){var i=this.options.resize.handle_append_to;return e(this.resize_handle_tpl).appendTo(i?e(i,t):t),this},a.resize_widget=function(e,t,i,s){var n=e.coords().grid,a=n.col,o=this.options.max_cols,r=n.size_y,d=n.col,l=d;t||(t=n.size_x),i||(i=n.size_y),o!==1/0&&(t=Math.min(t,o-a+1)),i>r&&this.add_faux_rows(Math.max(i-r,0));var c=a+t-1;c>this.cols&&this.add_faux_cols(c-this.cols);var u={col:l,row:n.row,size_x:t,size_y:i};return this.mutate_widget_in_gridmap(e,n,u),this.set_dom_grid_height(),this.set_dom_grid_width(),s&&s.call(this,u.size_x,u.size_y),e},a.mutate_widget_in_gridmap=function(t,i,s){var n=(i.size_x,i.size_y),a=this.get_cells_occupied(i),o=this.get_cells_occupied(s),r=[];e.each(a.cols,function(t,i){-1===e.inArray(i,o.cols)&&r.push(i)});var d=[];e.each(o.cols,function(t,i){-1===e.inArray(i,a.cols)&&d.push(i)});var l=[];e.each(a.rows,function(t,i){-1===e.inArray(i,o.rows)&&l.push(i)});var c=[];if(e.each(o.rows,function(t,i){-1===e.inArray(i,a.rows)&&c.push(i)}),this.remove_from_gridmap(i),d.length){var u=[s.col,s.row,s.size_x,Math.min(n,s.size_y),t];this.empty_cells.apply(this,u)}if(c.length){var h=[s.col,s.row,s.size_x,s.size_y,t];this.empty_cells.apply(this,h)}if(i.col=s.col,i.row=s.row,i.size_x=s.size_x,i.size_y=s.size_y,this.add_to_gridmap(s,t),t.removeClass("player-revert"),t.data("coords").update({width:s.size_x*this.options.widget_base_dimensions[0]+(s.size_x-1)*this.options.widget_margins[0]*2,height:s.size_y*this.options.widget_base_dimensions[1]+(s.size_y-1)*this.options.widget_margins[1]*2}),t.attr({"data-col":s.col,"data-row":s.row,"data-sizex":s.size_x,"data-sizey":s.size_y}),r.length){var p=[r[0],s.row,r.length,Math.min(n,s.size_y),t];this.remove_empty_cells.apply(this,p)}if(l.length){var f=[s.col,s.row,s.size_x,s.size_y,t];this.remove_empty_cells.apply(this,f)}return this.move_widget_up(t),this},a.empty_cells=function(t,i,s,n,a){return this.widgets_below({col:t,row:i-n,size_x:s,size_y:n}).not(a).each(e.proxy(function(t,s){var a=e(s).coords().grid;if(a.row<=i+n-1){var o=i+n-a.row;this.move_widget_down(e(s),o)}},this)),this.set_dom_grid_height(),this},a.remove_empty_cells=function(t,i,s,n,a){return this.widgets_below({col:t,row:i,size_x:s,size_y:n}).not(a).each(e.proxy(function(t,i){this.move_widget_up(e(i),n)},this)),this.set_dom_grid_height(),this},a.next_position=function(e,t){e||(e=1),t||(t=1);for(var i,n=this.gridmap,a=n.length,o=[],r=1;r<a;r++){i=n[r].length;for(var d=1;d<=i;d++)this.can_move_to({size_x:e,size_y:t},r,d)&&o.push({col:r,row:d,size_y:t,size_x:e})}return!!o.length&&s.sort_by_row_and_col_asc(o)[0]},a.remove_widget=function(t,i,s){var n=t instanceof e?t:e(t),a=n.coords().grid;e.isFunction(i)&&(s=i,i=!1),this.cells_occupied_by_placeholder={},this.$widgets=this.$widgets.not(n);var o=this.widgets_below(n);return this.remove_from_gridmap(a),n.fadeOut(e.proxy(function(){n.remove(),i||o.each(e.proxy(function(t,i){this.move_widget_up(e(i),a.size_y)},this)),this.set_dom_grid_height(),s&&s.call(this,t)},this)),this},a.remove_all_widgets=function(t){return this.$widgets.each(e.proxy(function(e,i){this.remove_widget(i,!0,t)},this)),this},a.serialize=function(t){return t||(t=this.$widgets),t.map(e.proxy(function(t,i){var s=e(i);return this.options.serialize_params(s,s.coords().grid)},this)).get()},a.serialize_changed=function(){return this.serialize(this.$changed)},a.dom_to_coords=function(e){return{col:parseInt(e.attr("data-col"),10),row:parseInt(e.attr("data-row"),10),size_x:parseInt(e.attr("data-sizex"),10)||1,size_y:parseInt(e.attr("data-sizey"),10)||1,max_size_x:parseInt(e.attr("data-max-sizex"),10)||!1,max_size_y:parseInt(e.attr("data-max-sizey"),10)||!1,min_size_x:parseInt(e.attr("data-min-sizex"),10)||!1,min_size_y:parseInt(e.attr("data-min-sizey"),10)||!1,el:e}},a.register_widget=function(t){var i=t instanceof jQuery,s=i?this.dom_to_coords(t):t,n=!1;i||(t=s.el);var a=this.can_go_widget_up(s);return a&&(s.row=a,t.attr("data-row",a),this.$el.trigger("gridster:positionchanged",[s]),n=!0),this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:s.size_x,size_y:s.size_y},s.col,s.row)&&(e.extend(s,this.next_position(s.size_x,s.size_y)),t.attr({"data-col":s.col,"data-row":s.row,"data-sizex":s.size_x,"data-sizey":s.size_y}),n=!0),t.data("coords",t.coords()),t.data("coords").grid=s,this.add_to_gridmap(s,t),this.options.resize.enabled&&this.add_resize_handle(t),n},a.update_widget_position=function(e,t){return this.for_each_cell_occupied(e,function(e,i){if(!this.gridmap[e])return this;this.gridmap[e][i]=t}),this},a.remove_from_gridmap=function(e){return this.update_widget_position(e,!1)},a.add_to_gridmap=function(t,i){this.update_widget_position(t,i||t.el),t.el&&this.widgets_below(t.el).each(e.proxy(function(t,i){this.move_widget_up(e(i))},this))},a.draggable=function(){var t=this,i=e.extend(!0,{},this.options.draggable,{offset_left:this.options.widget_margins[0],offset_top:this.options.widget_margins[1],container_width:this.cols*this.min_widget_width,limit:!0,start:function(i,s){t.$widgets.filter(".player-revert").removeClass("player-revert"),t.$player=e(this),t.$helper=e(s.$helper),t.helper=!t.$helper.is(t.$player),t.on_start_drag.call(t,i,s),t.$el.trigger("gridster:dragstart")},stop:function(e,i){t.on_stop_drag.call(t,e,i),t.$el.trigger("gridster:dragstop")},drag:throttle(function(e,i){t.on_drag.call(t,e,i),t.$el.trigger("gridster:drag")},60)});return this.drag_api=this.$el.drag(i),this},a.resizable=function(){return this.resize_api=this.$el.drag({items:"."+this.options.resize.handle_class,offset_left:this.options.widget_margins[0],container_width:this.container_width,move_element:!1,resize:!0,limit:!this.options.autogrow_cols,start:e.proxy(this.on_start_resize,this),stop:e.proxy(function(t,i){delay(e.proxy(function(){this.on_stop_resize(t,i)},this),120)},this),drag:throttle(e.proxy(this.on_resize,this),60)}),this},a.setup_resize=function(){this.resize_handle_class=this.options.resize.handle_class;var t=this.options.resize.axes,i='<span class="'+this.resize_handle_class+" "+this.resize_handle_class+'-{type}" />';return this.resize_handle_tpl=e.map(t,function(e){return i.replace("{type}",e)}).join(""),e.isArray(this.options.draggable.ignore_dragging)&&this.options.draggable.ignore_dragging.push("."+this.resize_handle_class),this},a.on_start_drag=function(t,i){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging"),this.highest_col=this.get_highest_occupied_cell().col,this.$player.addClass("player"),this.player_grid_data=this.$player.coords().grid,this.placeholder_grid_data=e.extend({},this.player_grid_data),this.set_dom_grid_height(this.$el.height()+this.player_grid_data.size_y*this.min_widget_height),this.set_dom_grid_width(this.cols);var s=this.player_grid_data.size_x,n=this.cols-this.highest_col;this.options.autogrow_cols&&n<=s&&this.add_faux_cols(Math.min(s-n,1));var a=this.faux_grid,o=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data),this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.last_cols=[],this.last_rows=[],this.collision_api=this.$helper.collision(a,this.options.collision),this.$preview_holder=e("<"+this.$player.get(0).tagName+" />",{'class':"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:o.width,height:o.height}}).appendTo(this.$el),this.options.draggable.start&&this.options.draggable.start.call(this,t,i)},a.on_drag=function(e,t){if(null===this.$player)return!1;var i={left:t.position.left+this.baseX,top:t.position.top+this.baseY};this.options.autogrow_cols&&(this.placeholder_grid_data.col+this.placeholder_grid_data.size_x-1>=this.cols-1&&this.options.max_cols>=this.cols+1&&(this.add_faux_cols(1),this.set_dom_grid_width(this.cols+1),this.drag_api.set_limits(this.container_width)),this.collision_api.set_colliders(this.faux_grid)),this.colliders_data=this.collision_api.get_closest_colliders(i),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.helper&&this.$player&&this.$player.css({left:t.position.left,top:t.position.top}),this.options.draggable.drag&&this.options.draggable.drag.call(this,e,t)},a.on_stop_drag=function(e,t){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging"),t.position.left=t.position.left+this.baseX,t.position.top=t.position.top+this.baseY,this.colliders_data=this.collision_api.get_closest_colliders(t.position),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.$player.addClass("player-revert").removeClass("player").attr({"data-col":this.placeholder_grid_data.col,"data-row":this.placeholder_grid_data.row}).css({left:"",top:""}),this.$changed=this.$changed.add(this.$player),this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data),this.set_cells_player_occupies(this.placeholder_grid_data.col,this.placeholder_grid_data.row),this.$player.coords().grid.row=this.placeholder_grid_data.row,this.$player.coords().grid.col=this.placeholder_grid_data.col,this.options.draggable.stop&&this.options.draggable.stop.call(this,e,t),this.$preview_holder.remove(),this.$player=null,this.$helper=null,this.placeholder_grid_data={},this.player_grid_data={},this.cells_occupied_by_placeholder={},this.cells_occupied_by_player={},this.set_dom_grid_height(),this.set_dom_grid_width(),this.options.autogrow_cols&&this.drag_api.set_limits(this.cols*this.min_widget_width)},a.on_start_resize=function(t,i){this.$resized_widget=i.$player.closest(".gs-w"),this.resize_coords=this.$resized_widget.coords(),this.resize_wgd=this.resize_coords.grid,this.resize_initial_width=this.resize_coords.coords.width,this.resize_initial_height=this.resize_coords.coords.height,this.resize_initial_sizex=this.resize_coords.grid.size_x,this.resize_initial_sizey=this.resize_coords.grid.size_y,this.resize_initial_col=this.resize_coords.grid.col,this.resize_last_sizex=this.resize_initial_sizex,this.resize_last_sizey=this.resize_initial_sizey,this.resize_max_size_x=Math.min(this.resize_wgd.max_size_x||this.options.resize.max_size[0],this.options.max_cols-this.resize_initial_col+1),this.resize_max_size_y=this.resize_wgd.max_size_y||this.options.resize.max_size[1],this.resize_min_size_x=this.resize_wgd.min_size_x||this.options.resize.min_size[0]||1,this.resize_min_size_y=this.resize_wgd.min_size_y||this.options.resize.min_size[1]||1,this.resize_initial_last_col=this.get_highest_occupied_cell().col,this.set_dom_grid_width(this.cols),this.resize_dir={right:i.$player.is("."+this.resize_handle_class+"-x"),bottom:i.$player.is("."+this.resize_handle_class+"-y")},this.$resized_widget.css({"min-width":this.options.widget_base_dimensions[0],"min-height":this.options.widget_base_dimensions[1]});var s=this.$resized_widget.get(0).tagName;this.$resize_preview_holder=e("<"+s+" />",{'class':"preview-holder resize-preview-holder","data-row":this.$resized_widget.attr("data-row"),"data-col":this.$resized_widget.attr("data-col"),css:{width:this.resize_initial_width,height:this.resize_initial_height}}).appendTo(this.$el),this.$resized_widget.addClass("resizing"),this.options.resize.start&&this.options.resize.start.call(this,t,i,this.$resized_widget),this.$el.trigger("gridster:resizestart")},a.on_stop_resize=function(t,i){this.$resized_widget.removeClass("resizing").css({width:"",height:""}),delay(e.proxy(function(){this.$resize_preview_holder.remove().css({"min-width":"","min-height":""}),this.options.resize.stop&&this.options.resize.stop.call(this,t,i,this.$resized_widget),this.$el.trigger("gridster:resizestop")},this),300),this.set_dom_grid_width(),this.options.autogrow_cols&&this.drag_api.set_limits(this.cols*this.min_widget_width)},a.on_resize=function(e,t){var i,s=t.pointer.diff_left,n=t.pointer.diff_top,a=this.options.widget_base_dimensions[0],o=this.options.widget_base_dimensions[1],r=this.options.widget_margins[0],d=this.options.widget_margins[1],l=this.resize_max_size_x,c=this.resize_min_size_x,u=this.resize_max_size_y,h=this.resize_min_size_y,p=this.options.autogrow_cols,f=1/0,_=1/0,m=Math.ceil(s/(a+2*r)-.2),g=Math.ceil(n/(o+2*d)-.2),v=Math.max(1,this.resize_initial_sizex+m),w=Math.max(1,this.resize_initial_sizey+g),b=this.container_width/this.min_widget_width-this.resize_initial_col+1,y=b*this.min_widget_width-2*r;if(v=Math.max(Math.min(v,l),c),v=Math.min(b,v),i=l*a+(v-1)*r*2,f=Math.min(i,y),min_width=c*a+(v-1)*r*2,w=Math.max(Math.min(w,u),h),_=u*o+(w-1)*d*2,min_height=h*o+(w-1)*d*2,this.resize_dir.right?w=this.resize_initial_sizey:this.resize_dir.bottom&&(v=this.resize_initial_sizex),p){var x=this.resize_initial_col+v-1;p&&this.resize_initial_last_col<=x&&(this.set_dom_grid_width(Math.max(x+1,this.cols)),this.cols<x&&this.add_faux_cols(x-this.cols))}var k={};!this.resize_dir.bottom&&(k.width=Math.max(Math.min(this.resize_initial_width+s,f),min_width)),!this.resize_dir.right&&(k.height=Math.max(Math.min(this.resize_initial_height+n,_),min_height)),this.$resized_widget.css(k),v===this.resize_last_sizex&&w===this.resize_last_sizey||(this.resize_widget(this.$resized_widget,v,w),this.set_dom_grid_width(this.cols),this.$resize_preview_holder.css({width:"",height:""}).attr({"data-row":this.$resized_widget.attr("data-row"),"data-sizex":v,"data-sizey":w})),this.options.resize.resize&&this.options.resize.resize.call(this,e,t,this.$resized_widget),this.$el.trigger("gridster:resize"),this.resize_last_sizex=v,this.resize_last_sizey=w},a.on_overlapped_column_change=function(t,i){if(!this.colliders_data.length)return this;var s,n=this.get_targeted_columns(this.colliders_data[0].el.data.col),a=this.last_cols.length,o=n.length;for(s=0;s<o;s++)-1===e.inArray(n[s],this.last_cols)&&(t||e.noop).call(this,n[s]);for(s=0;s<a;s++)-1===e.inArray(this.last_cols[s],n)&&(i||e.noop).call(this,this.last_cols[s]);return this.last_cols=n,this},a.on_overlapped_row_change=function(t,i){if(!this.colliders_data.length)return this;var s,n=this.get_targeted_rows(this.colliders_data[0].el.data.row),a=this.last_rows.length,o=n.length;for(s=0;s<o;s++)-1===e.inArray(n[s],this.last_rows)&&(t||e.noop).call(this,n[s]);for(s=0;s<a;s++)-1===e.inArray(this.last_rows[s],n)&&(i||e.noop).call(this,this.last_rows[s]);this.last_rows=n},a.set_player=function(e,t,i){var s=this;i||this.empty_cells_player_occupies();var n=i?{col:e}:s.colliders_data[0].el.data,a=n.col,o=t||n.row;this.player_grid_data={col:a,row:o,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x},this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);var r=this.get_widgets_overlapped(this.player_grid_data),d=this.widgets_constraints(r);if(this.manage_movements(d.can_go_up,a,o),this.manage_movements(d.can_not_go_up,a,o),!r.length){var l=this.can_go_player_up(this.player_grid_data);!1!==l&&(o=l),this.set_placeholder(a,o)}return{col:a,row:o}},a.widgets_constraints=function(t){var i=e([]),n=[],a=[];return t.each(e.proxy(function(t,s){var o=e(s),r=o.coords().grid;this.can_go_widget_up(r)?(i=i.add(o),n.push(r)):a.push(r)},this)),t.not(i),{can_go_up:s.sort_by_row_asc(n),can_not_go_up:s.sort_by_row_desc(a)}},a.manage_movements=function(t,i,s){return e.each(t,e.proxy(function(e,t){var n=t,a=n.el,o=this.can_go_widget_up(n);if(o)this.move_widget_to(a,o),this.set_placeholder(i,o+n.size_y);else if(!this.can_go_player_up(this.player_grid_data)){var r=s+this.player_grid_data.size_y-n.row;this.move_widget_down(a,r),this.set_placeholder(i,s)}},this)),this},a.is_player=function(e,t){if(t&&!this.gridmap[e])return!1;var i=t?this.gridmap[e][t]:e;return i&&(i.is(this.$player)||i.is(this.$helper))},a.is_player_in=function(t,i){var s=this.cells_occupied_by_player||{};return e.inArray(t,s.cols)>=0&&e.inArray(i,s.rows)>=0},a.is_placeholder_in=function(t,i){var s=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(t)&&e.inArray(i,s.rows)>=0},a.is_placeholder_in_col=function(t){var i=this.cells_occupied_by_placeholder||[];return e.inArray(t,i.cols)>=0},a.is_empty=function(e,t){return void 0===this.gridmap[e]||void 0!==this.gridmap[e][t]&&!1===this.gridmap[e][t]},a.is_occupied=function(e,t){return!!this.gridmap[e]&&!!this.gridmap[e][t]},a.is_widget=function(e,t){var i=this.gridmap[e];return!!i&&((i=i[t])||!1)},a.is_widget_under_player=function(e,t){return!!this.is_widget(e,t)&&this.is_player_in(e,t)},a.get_widgets_under_player=function(t){t||(t=this.cells_occupied_by_player||{cols:[],rows:[]});var i=e([]);return e.each(t.cols,e.proxy(function(s,n){e.each(t.rows,e.proxy(function(e,t){this.is_widget(n,t)&&(i=i.add(this.gridmap[n][t]))},this))},this)),i},a.set_placeholder=function(t,i){var s=e.extend({},this.placeholder_grid_data),n=this.widgets_below({col:s.col,row:s.row,size_y:s.size_y,size_x:s.size_x}),a=t+s.size_x-1;a>this.cols&&(t-=a-t);var o=this.placeholder_grid_data.row<i,r=this.placeholder_grid_data.col!==t;this.placeholder_grid_data.col=t,this.placeholder_grid_data.row=i,this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.$preview_holder.attr({"data-row":i,"data-col":t}),(o||r)&&n.each(e.proxy(function(i,n){this.move_widget_up(e(n),this.placeholder_grid_data.col-t+s.size_y)},this));var d=this.get_widgets_under_player(this.cells_occupied_by_placeholder);d.length&&d.each(e.proxy(function(t,n){var a=e(n);this.move_widget_down(a,i+s.size_y-a.data("coords").grid.row)},this))},a.can_go_player_up=function(e){var t=e.row+e.size_y-1,i=!0,s=[],n=1e4,a=this.get_widgets_under_player();return this.for_each_column_occupied(e,function(e){var o=this.gridmap[e],r=t+1;for(s[e]=[];--r>0&&(this.is_empty(e,r)||this.is_player(e,r)||this.is_widget(e,r)&&o[r].is(a));)s[e].push(r),n=r<n?r:n;if(0===s[e].length)return i=!1,!0;s[e].sort(function(e,t){return e-t})}),!!i&&this.get_valid_rows(e,s,n)},a.can_go_widget_up=function(e){var t=e.row+e.size_y-1,i=!0,s=[],n=1e4;return this.for_each_column_occupied(e,function(a){var o=this.gridmap[a];s[a]=[];for(var r=t+1;--r>0&&(!this.is_widget(a,r)||this.is_player_in(a,r)||o[r].is(e.el));)this.is_player(a,r)||this.is_placeholder_in(a,r)||this.is_player_in(a,r)||s[a].push(r),r<n&&(n=r);if(0===s[a].length)return i=!1,!0;s[a].sort(function(e,t){return e-t})}),!!i&&this.get_valid_rows(e,s,n)},a.get_valid_rows=function(t,i,s){for(var n=t.row,a=t.row+t.size_y-1,o=t.size_y,r=s-1,d=[];++r<=a;){var l=!0;if(e.each(i,function(t,i){e.isArray(i)&&-1===e.inArray(r,i)&&(l=!1)}),!0===l&&(d.push(r),d.length===o))break}var c=!1;return 1===o?d[0]!==n&&(c=d[0]||!1):d[0]!==n&&(c=this.get_consecutive_numbers_index(d,o)),c},a.get_consecutive_numbers_index=function(e,t){for(var i=e.length,s=[],n=!0,a=-1,o=0;o<i;o++){if(n||e[o]===a+1){if(s.push(o),s.length===t)break;n=!1}else s=[],n=!0;a=e[o]}return s.length>=t&&e[s[0]]},a.get_widgets_overlapped=function(){var t=e([]),i=[],s=this.cells_occupied_by_player.rows.slice(0);return s.reverse(),e.each(this.cells_occupied_by_player.cols,e.proxy(function(n,a){e.each(s,e.proxy(function(s,n){if(!this.gridmap[a])return!0;var o=this.gridmap[a][n];this.is_occupied(a,n)&&!this.is_player(o)&&-1===e.inArray(o,i)&&(t=t.add(o),i.push(o))},this))},this)),t},a.on_start_overlapping_column=function(e){this.set_player(e,!1)},a.on_start_overlapping_row=function(e){this.set_player(!1,e)},a.on_stop_overlapping_column=function(e){this.set_player(e,!1);var t=this;this.for_each_widget_below(e,this.cells_occupied_by_player.rows[0],function(e,i){t.move_widget_up(this,t.player_grid_data.size_y)})},a.on_stop_overlapping_row=function(e){this.set_player(!1,e);for(var t=this,i=this.cells_occupied_by_player.cols,s=0,n=i.length;s<n;s++)this.for_each_widget_below(i[s],e,function(e,i){t.move_widget_up(this,t.player_grid_data.size_y)})},a.move_widget_to=function(t,i){var s=this,n=t.coords().grid,a=(n.row,this.widgets_below(t));return!1!==this.can_move_to(n,n.col,i,t)&&(this.remove_from_gridmap(n),n.row=i,this.add_to_gridmap(n),t.attr("data-row",i),this.$changed=this.$changed.add(t),a.each(function(t,i){var n=e(i),a=n.coords().grid,o=s.can_go_widget_up(a);o&&o!==a.row&&s.move_widget_to(n,o)}),this)},a.move_widget_up=function(t,i){var s=t.coords().grid,n=s.row,a=[];if(i||(i=1),!this.can_go_up(t))return!1;this.for_each_column_occupied(s,function(s){if(-1===e.inArray(t,a)){var o=t.coords().grid,r=n-i;if(!(r=this.can_go_up_to_row(o,s,r)))return!0;var d=this.widgets_below(t);this.remove_from_gridmap(o),o.row=r,this.add_to_gridmap(o),t.attr("data-row",o.row),this.$changed=this.$changed.add(t),a.push(t),d.each(e.proxy(function(t,s){this.move_widget_up(e(s),i)},this))}})},a.move_widget_down=function(t,i){var s,n,a,o;if(i<=0)return!1;if(s=t.coords().grid,n=s.row,a=[],o=i,!t)return!1;if(-1===e.inArray(t,a)){var r=t.coords().grid,d=n+i,l=this.widgets_below(t);this.remove_from_gridmap(r),l.each(e.proxy(function(t,i){var s=e(i),n=s.coords().grid,a=this.displacement_diff(n,r,o);a>0&&this.move_widget_down(s,a)},this)),r.row=d,this.update_widget_position(r,t),t.attr("data-row",r.row),this.$changed=this.$changed.add(t),a.push(t)}},a.can_go_up_to_row=function(t,i,s){var n,a=this.gridmap,o=!0,r=[],d=t.row;if(this.for_each_column_occupied(t,function(e){for(a[e],r[e]=[],n=d;n--&&this.is_empty(e,n)&&!this.is_placeholder_in(e,n);)r[e].push(n);if(!r[e].length)return o=!1,!0}),!o)return!1;for(n=s,n=1;n<d;n++){for(var l=!0,c=0,u=r.length;c<u;c++)r[c]&&-1===e.inArray(n,r[c])&&(l=!1);if(!0===l){o=n;break}}return o},a.displacement_diff=function(e,t,i){var s=e.row,n=[],a=t.row+t.size_y;return this.for_each_column_occupied(e,function(e){for(var t=0,i=a;i<s;i++)this.is_empty(e,i)&&(t+=1);n.push(t)}),i-=Math.max.apply(Math,n),i>0?i:0},a.widgets_below=function(t){var i=e.isPlainObject(t)?t:t.coords().grid,n=this,a=(this.gridmap,i.row+i.size_y-1),o=e([]);return this.for_each_column_occupied(i,function(t){n.for_each_widget_below(t,a,function(t,i){if(!n.is_player(this)&&-1===e.inArray(this,o))return o=o.add(this),!0})}),s.sort_by_row_asc(o)},a.set_cells_player_occupies=function(e,t){return this.remove_from_gridmap(this.placeholder_grid_data),this.placeholder_grid_data.col=e,this.placeholder_grid_data.row=t,this.add_to_gridmap(this.placeholder_grid_data,this.$player),this},a.empty_cells_player_occupies=function(){return this.remove_from_gridmap(this.placeholder_grid_data),this},a.can_go_up=function(e){var t=e.coords().grid,i=t.row,s=i-1,n=(this.gridmap,!0);return 1!==i&&(this.for_each_column_occupied(t,function(e){if(this.is_widget(e,s),this.is_occupied(e,s)||this.is_player(e,s)||this.is_placeholder_in(e,s)||this.is_player_in(e,s))return n=!1,!0}),n)},a.can_move_to=function(e,t,i,s){var n=(this.gridmap,e.el),a={size_y:e.size_y,size_x:e.size_x,col:t,row:i},o=!0;return!(t+e.size_x-1>this.cols)&&!(s&&s<i+e.size_y-1)&&(this.for_each_cell_occupied(a,function(t,i){var s=this.is_widget(t,i);!s||e.el&&!s.is(n)||(o=!1)}),o)},a.get_targeted_columns=function(e){for(var t=(e||this.player_grid_data.col)+(this.player_grid_data.size_x-1),i=[],s=e;s<=t;s++)i.push(s);return i},a.get_targeted_rows=function(e){for(var t=(e||this.player_grid_data.row)+(this.player_grid_data.size_y-1),i=[],s=e;s<=t;s++)i.push(s);return i},a.get_cells_occupied=function(t){var i,s={cols:[],rows:[]};for(arguments[1]instanceof e&&(t=arguments[1].coords().grid),i=0;i<t.size_x;i++){var n=t.col+i;s.cols.push(n)}for(i=0;i<t.size_y;i++){var a=t.row+i;s.rows.push(a)}return s},a.for_each_cell_occupied=function(e,t){return this.for_each_column_occupied(e,function(i){this.for_each_row_occupied(e,function(e){t.call(this,i,e)})}),this},a.for_each_column_occupied=function(e,t){for(var i=0;i<e.size_x;i++){var s=e.col+i;t.call(this,s,e)}},a.for_each_row_occupied=function(e,t){for(var i=0;i<e.size_y;i++){var s=e.row+i;t.call(this,s,e)}},a._traversing_widgets=function(t,i,s,n,a){var o=this.gridmap;if(o[s]){var r,d,l=t+"/"+i;if(arguments[2]instanceof e){var c=arguments[2].coords().grid;s=c.col,n=c.row,a=arguments[3]}var u=[],h=n,p={"for_each/above":function(){for(;h--&&!(h>0&&this.is_widget(s,h)&&-1===e.inArray(o[s][h],u)&&(r=a.call(o[s][h],s,h),u.push(o[s][h]),r)););},"for_each/below":function(){for(h=n+1,d=o[s].length;h<d&&(!this.is_widget(s,h)||-1!==e.inArray(o[s][h],u)||(r=a.call(o[s][h],s,h),u.push(o[s][h]),!r));h++);}};p[l]&&p[l].call(this)}},a.for_each_widget_above=function(e,t,i){return this._traversing_widgets("for_each","above",e,t,i),this},a.for_each_widget_below=function(e,t,i){return this._traversing_widgets("for_each","below",e,t,i),this},a.get_highest_occupied_cell=function(){for(var e,t=this.gridmap,i=t[1].length,s=[],n=[],a=t.length-1;a>=1;a--)for(e=i-1;e>=1;e--)if(this.is_widget(a,e)){s.push(e),n.push(a);break}return{col:Math.max.apply(Math,n),row:Math.max.apply(Math,s)}},a.get_widgets_from=function(t,i){var s=(this.gridmap,e());return t&&(s=s.add(this.$widgets.filter(function(){var i=e(this).attr("data-col");return i===t||i>t}))),i&&(s=s.add(this.$widgets.filter(function(){var t=e(this).attr("data-row");return t===i||t>i}))),s},a.set_dom_grid_height=function(e){return void 0===e&&(e=this.get_highest_occupied_cell().row*this.min_widget_height),this.container_height=e,this.$el.css("height",this.container_height),this},a.set_dom_grid_width=function(e){void 0===e&&(e=this.get_highest_occupied_cell().col);var t=this.options.autogrow_cols?this.options.max_cols:this.cols;return e=Math.min(t,Math.max(e,this.options.min_cols)),this.container_width=e*this.min_widget_width,this.$el.css("width",this.container_width),this},a.generate_stylesheet=function(t){var i,n="",a=this.options.max_size_x||this.cols;t||(t={}),t.cols||(t.cols=this.cols),t.rows||(t.rows=this.rows),t.namespace||(t.namespace=this.options.namespace),t.widget_base_dimensions||(t.widget_base_dimensions=this.options.widget_base_dimensions),t.widget_margins||(t.widget_margins=this.options.widget_margins),t.min_widget_width=2*t.widget_margins[0]+t.widget_base_dimensions[0],t.min_widget_height=2*t.widget_margins[1]+t.widget_base_dimensions[1];var o=e.param(t);if(e.inArray(o,s.generated_stylesheets)>=0)return!1;for(this.generated_stylesheets.push(o),s.generated_stylesheets.push(o),i=t.cols;i>=0;i--)n+=t.namespace+' [data-col="'+(i+1)+'"] { left:'+(i*t.widget_base_dimensions[0]+i*t.widget_margins[0]+(i+1)*t.widget_margins[0])+"px; }\n";for(i=t.rows;i>=0;i--)n+=t.namespace+' [data-row="'+(i+1)+'"] { top:'+(i*t.widget_base_dimensions[1]+i*t.widget_margins[1]+(i+1)*t.widget_margins[1])+"px; }\n";for(var r=1;r<=t.rows;r++)n+=t.namespace+' [data-sizey="'+r+'"] { height:'+(r*t.widget_base_dimensions[1]+(r-1)*(2*t.widget_margins[1]))+"px; }\n";for(var d=1;d<=a;d++)n+=t.namespace+' [data-sizex="'+d+'"] { width:'+(d*t.widget_base_dimensions[0]+(d-1)*(2*t.widget_margins[0]))+"px; }\n";return this.remove_style_tags(),this.add_style_tag(n)},a.add_style_tag=function(e){var t=document,i=t.createElement("style");return t.getElementsByTagName("head")[0].appendChild(i),i.setAttribute("type","text/css"),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),this.$style_tags=this.$style_tags.add(i),this},a.remove_style_tags=function(){var t=s.generated_stylesheets,i=this.generated_stylesheets;this.$style_tags.remove(),s.generated_stylesheets=e.map(t,function(t){if(-1===e.inArray(t,i))return t})},a.generate_faux_grid=function(e,t){this.faux_grid=[],this.gridmap=[];var i,s;for(i=t;i>0;i--)for(this.gridmap[i]=[],s=e;s>0;s--)this.add_faux_cell(s,i);return this},a.add_faux_cell=function(t,i){var s=e({left:this.baseX+(i-1)*this.min_widget_width,top:this.baseY+(t-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:i,row:t,original_col:i,original_row:t}).coords();return e.isArray(this.gridmap[i])||(this.gridmap[i]=[]),this.gridmap[i][t]=!1,this.faux_grid.push(s),this},a.add_faux_rows=function(e){for(var t=this.rows,i=t+(e||1),s=i;s>t;s--)for(var n=this.cols;n>=1;n--)this.add_faux_cell(s,n);return this.rows=i,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},a.add_faux_cols=function(e){var t=this.cols,i=t+(e||1);i=Math.min(i,this.options.max_cols);for(var s=t+1;s<=i;s++)for(var n=this.rows;n>=1;n--)this.add_faux_cell(n,s);return this.cols=i,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},a.recalculate_faux_grid=function(){var t=this.$wrapper.width();return this.baseX=(e(window).width()-t)/2,this.baseY=this.$wrapper.offset().top,e.each(this.faux_grid,e.proxy(function(e,t){this.faux_grid[e]=t.update({left:this.baseX+(t.data.col-1)*this.min_widget_width,top:this.baseY+(t.data.row-1)*this.min_widget_height})},this)),this},a.get_widgets_from_DOM=function(){var t=this.$widgets.map(e.proxy(function(t,i){var s=e(i);return this.dom_to_coords(s)},this));return t=s.sort_by_row_and_col_asc(t),e(t).map(e.proxy(function(e,t){return this.register_widget(t)||null},this)).length&&this.$el.trigger("gridster:positionschanged"),this},a.generate_grid_and_stylesheet=function(){var t=this.$wrapper.width(),i=this.options.max_cols,s=Math.floor(t/this.min_widget_width)+this.options.extra_cols,n=this.$widgets.map(function(){return e(this).attr("data-col")}).get();n.length||(n=[0]);var a=Math.max.apply(Math,n);this.cols=Math.max(a,s,this.options.min_cols),i!==1/0&&i>=a&&i<this.cols&&(this.cols=i);var o=this.options.extra_rows;return this.$widgets.each(function(t,i){o+=+e(i).attr("data-sizey")}),this.rows=Math.max(o,this.options.min_rows),this.baseX=(e(window).width()-t)/2,this.baseY=this.$wrapper.offset().top,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this.generate_faux_grid(this.rows,this.cols)},a.destroy=function(t){return this.$el.removeData("gridster"),e(window).unbind(".gridster"),this.drag_api&&this.drag_api.destroy(),this.remove_style_tags(),t&&this.$el.remove(),this},e.fn.gridster=function(t){return this.each(function(){e(this).data("gridster")||e(this).data("gridster",new s(this,t))})},s}),function(n,a){s=[i(0)],void 0!==(d=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=d)}(0,function(e,t,i,s){"use strict";function n(t){return e(t).length>0}function a(t,i,s){var n=e.extend(!0,{},i,{success:function(t,i,n){e.isFunction(s)&&s(t,i,n)}});e.isFunction(v.ajax)?v.ajax(t,n):e.isFunction(e.ajax)?e.ajax(n):console.error("未找到ajax方法定义，加载新建菜单失败")}function o(e,t){return t.templates.box(e)}function r(e,t,i,s){var a=s.selector,o=e.children(a.content),r=e.children(a.heading),d=e.closest(a.column).data("gridster");if(!(n(e)&&n(o)&&n(r)&&n(d)))return!1;d.resize_widget(e,t,i,function(e,t){o.height(function(){return d.min_widget_height*t-2*d.options.widget_margins[1]-r.outerHeight(!0)-o.outerHeight(!0)+o.height()})})}function d(e,t){var i=t.selector,s=e.children(i.content),a=e.children(i.heading);if(!n(e)||!n(s)||!n(a))return!1;var o,d,l=e.data("size")||"original";switch(e.data("slide")||"down"){case"down":case"DOWN":switch(l){case"original":case"ORIGINAL":o=e.data("orgSizex")||e.data("sizex");break;case"max":case"MAX":o=e.data("maxSizex")||e.data("sizex");break;default:return!1}r(e,o,1,t),e.data("slide","up");break;case"up":case"UP":switch(l){case"original":case"ORIGINAL":o=e.data("orgSizex")||e.data("sizex"),d=e.data("orgSizey")||e.data("sizey");break;case"max":case"MAX":o=e.data("maxSizex")||e.data("sizex"),d=e.data("maxSizey")||e.data("sizey");break;default:return!1}r(e,o,d,t),e.data("slide","down");break;default:return!1}return s.slideToggle(t.slideSpeed),!0}function l(t,i){if(!n(t))return!1;var s,a=i.selector,o=(t.find(a.resize),t.data("briefUrl")||""),r=t.data("detailUrl")||"",d=t.children(a.content);switch(t.data("size")||"original"){case"original":case"ORIGINAL":s=o||"";break;case"max":case"MAX":s=r||"";break;default:return!1}return s&&d.children().fadeOut(i.fadeSpeed,function(){i.getData(s,i.ajax,function(t,s,n){d.empty().append(t),e.isFunction(i.onContendLoaded)&&i.onContendLoaded(d)})}),!0}function c(e,t,i,s){var n=s||o(t,i),a=i.sizeScaler,d=[t.size[0]*a[0],t.size[1]*a[1]],c=t.position,u=[t.maxSize[0]*a[0],t.maxSize[1]*a[1]],h=e.add_widget(n,d[0],d[1],c[0],c[1]);return h.data("maxSizex",u[0]).data("maxSizey",u[1]),r(h,h.data("sizex"),h.data("sizey"),i),l(h,i),h}function u(t,i,s,a){return!(!n(i)||!n(t)||(t.remove_widget(i,s,function(){e.isFunction(a)&&a(t)}),0))}function h(t,i){return t.remove_all_widgets(function(){e.isFunction(i)&&i(t)}),!0}function p(e){return!e.drag_api.disabled}function f(e){return e.disable(),!0}function _(e){return e.enable(),!0}function m(e,t){var i,s,n=e,a=t.selector,o=t.icons,d=n.children("i"),c=n.closest(a.box),u=(n.siblings(a.title).html(),c.data("size")||"original"),h=c.data("slide")||"down";switch(u){case"original":case"ORIGINAL":switch(c.data("orgSizex",c.data("sizex")).data("orgSizey",c.data("sizey")),i=c.data("maxSizex")||c.data("sizex"),h){case"up":case"UP":s=1;break;case"down":case"DOWN":s=c.data("maxSizey")||c.data("sizey");break;default:return!1}c.data("size","max");break;case"max":case"MAX":switch(i=c.data("orgSizex")||c.data("sizex"),h){case"up":case"UP":s=1;break;case"down":case"DOWN":s=c.data("orgSizey")||c.data("sizey");break;default:return!1}c.data("size","original");break;default:return!1}d.toggleClass(o.resize[0]).toggleClass(o.resize[1]),r(c,i,s,t),l(c,t)}function g(t,i){var s=i.selector,a=i.icons;return!!n(s.column,t)&&(t.on("uc:initDragboxes",function(){e(this).find(s.box).each(function(){var t=e(this);r(t,t.data("sizex"),t.data("sizey"),i),l(t,i)})}),t.on("click",s.refresh,function(){l(e(this).closest(s.box),i),e.isFunction(i.onBoxRefreshed)&&i.onBoxRefreshed(e(this).closest(s.box))}),t.on("click",s.resize,function(){m(e(this),i),e.isFunction(i.onBoxResized)&&i.onBoxResized(e(this).closest(s.box))}),t.on("click",s.toggle,function(){e(this).children("i").toggleClass(a.toggle[0]).toggleClass(a.toggle[1]),d(e(this).closest(s.box),i)}),t.on("click",s.remove,function(){var t=e(this).closest(s.box),n=t.closest(s.column).data("gridster");u(n,t,i.silent),e.isFunction(i.onBoxRemoved)&&i.onBoxRemoved(n)}),!0)}if(!e)return{};var v=t.udesk=t.udesk||{},w={namespace:"",widget_selector:".dragbox",draggable:{handle:".dragbox-heading"},selector:{column:".dragbox-column",box:".dragbox",heading:".dragbox-heading",title:"h4",content:".dragbox-content","drag-handle":".dragbox-heading",refresh:".refresh-box",resize:".maximize-box",toggle:".toggle-box",remove:".remove-box"},max_cols:28,widget_base_dimensions:[40,40],widget_margins:[3,3],resize:{enabled:!1,max_size:[3,3],min_size:[1,1]},sizeScaler:[4,4],icons:{resize:["fa fa-expand","fa fa-compress"],toggle:["fa fa-minus","fa fa-plus"]},ajax:{},getData:a,newBox:{id:"newDragbox",position:[1,1],size:[1,1],maxSize:[4,3],briefUrl:s,detailUrl:s,title:"Title",content:"<p> Lorem ipsum dolor sit amet, consectetuer adipiscing elit </p>"},templates:{column:v.template?v.template('<div class="dragbox-column"></div>'):s,box:v.template?v.template('<div class="dragbox" id="{{=it.id}}" data-brief-url="{{=it.briefUrl}}" data-detail-url ="{{=it.detailUrl}}"><div class="dragbox-heading"><h4>{{=it.title}}</h4><a class="remove-box"><i class="menu-icon fa fa-remove"></i></a><a class="toggle-box"><i class="menu-icon fa fa-minus"></i></a><a class="maximize-box"><i class="menu-icon fa fa-expand"></i></a><a class="refresh-box"><i class="menu-icon fa fa-refresh"></i></a></div><div class="dragbox-content" >{{=it.content}}</div></div>'):s},fadeSpeed:500,slideSpeed:200,silent:!1,onInit:function(e){},onContendLoaded:function(e){},onBoxAdded:function(e){},onBoxRemoved:function(e){},onAllRemoved:function(e){},onAllFixed:function(e){},onAllUnfixed:function(e){},onBoxResized:function(e){},onBoxRefreshed:function(e){}},b=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(b.prototype,{constructor:b,VERSION:"3.4.0",init:function(){var t=this.options,i=t.selector.column,s=this.$element,n=s.children(i)||s.append(t.templates.column(t)).children(i);return this.gridster=n.gridster(t).data("gridster"),g(s,t),s.trigger("uc:initDragboxes"),e.isFunction(t.onInit)&&t.onInit(this.gridster),this},addBox:function(t,i){var s,n=this.options,a=e.extend(!0,{},n.newBox,t);return s="Function"==typeof i?c(this.gridster,a,n,i(t)):c(this.gridster,a,n),e.isFunction(n.onBoxAdded)&&n.onBoxAdded(s),this},removeBox:function(t,i,s){return u(this.gridster,t,i,s),e.isFunction(this.options.onBoxRemoved)&&this.options.onBoxRemoved(this.gridster),this},removeAll:function(t){return h(this.gridster,t),e.isFunction(this.options.onAllRemoved)&&this.options.onAllRemoved(this.gridster),this},refrshBox:function(t,i){var s=this.options;l(t,s),e.isFunction(i)&&i(),e.isFunction(s.onBoxRefreshed)&&s.onBoxRefreshed(e(this).closest(selector.box))},isDraggable:function(){return p(this.gridster)},fixAll:function(){return f(this.gridster),e.isFunction(this.options.onAllFixed)&&this.options.onAllFixed(this.gridster),this},unfixAll:function(){return _(this.gridster),e.isFunction(this.options.onAllUnfixed)&&this.options.onAllUnfixed(this.gridster),this}}),e.fn.udeskDragbox=function(t){var i=e.extend(!0,{},e.fn.udeskDragbox.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskDragbox")||t.data("udeskDragbox",new e.fn.udeskDragbox.constructor(t,i))})},e.fn.udeskDragbox.defaults=w,e.fn.udeskDragbox.constructor=b})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";if(!e)return{};var n=(t.udesk=t.udesk||{},"udeskLoadingMask"),a={color:"#FFFFFF",template:'<div class="u-loadingmask"><a class="u-loadingimg"></a></div>',fadeSpeed:500,onInit:function(e){},onMaskAdded:function(e){},onMaskRemoved:function(e){}},o=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,o.prototype,{constructor:o,VERSION:"3.4.0",$mask:s,isShown:!1,init:function(){var t=this.options,i=e(t.template);return i.css({"background-color":t.color}),this.$mask=i,e.isFunction(this.options.onInit)&&this.options.onInit(this.$mask),this.addMask()},addMask:function(){if(this.isShown)return this;var t=this.$element;return t.css({position:"relative"}),this.$mask.css({display:"inline"}),this.$mask.prependTo(t),this.isShown=!0,e.isFunction(this.options.onMaskAdded)&&this.options.onMaskAdded(this.$mask),this},removeMask:function(){if(!this.isShown)return this;var t=this,i=t.options,s=t.$mask;return s.fadeOut(i.fadeSpeed,function(){s.remove(),t.isShown=!1,e.isFunction(i.onMaskRemoved)&&i.onMaskRemoved(t.$element)}),t}}),e.fn[n]=function(t){var i=e.extend(!0,{},e.fn[n].defaults,t);return this.each(function(){var t=e(this);e(this).data(n)||t.data(n,new e.fn[n].constructor(t,i))})},e.fn[n].defaults=a,e.fn[n].constructor=o})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t,i){return e.isFunction(i)?i(t):(d.error("菜单项模板方法错误"),s)}function a(e,t,i){var o,r,d=[];for(o=0;o<e.length;o++){var l=i&&e[o].submenuUrl?[]:s;r={text:n(e[o],t.templates.itemText),encoded:!1,items:e[o].items?a(e[o].items,t):l},d.push(r)}return d}function o(t,i,s){var n=e.extend(!0,{},i,{success:function(t,i,n){e.isFunction(s)&&s(t,i,n)}});e.isFunction(d.ajax)?d.ajax(t,n):e.isFunction(e.ajax)?e.ajax(n):console.error("未找到ajax方法定义，加载新建菜单失败")}function r(t){var i=t,s=i.options;return i.$element.on("click","span.k-link a",function(){e.isFunction(s.onClick)&&s.onClick(e(this))}),i.$element.on("hover","span.k-link a",function(){e.isFunction(s.onHover)&&s.onHover(e(this))}),i}var d=t.udesk=t.udesk||{},l={localData:s,openOnClick:!0,url:"",ajax:{},getData:o,templates:{itemText:d.template?d.template('<a data-sys-id="#=data[i].sysId#" data-submenu-url="{{=it.submenuUrl}}" data-tab-url="{{=it.tabUrl}}" data-tab-mode="{{=it.tabMode}}" data-loaded="false">{{=it.shortName}}</a>'):s},onOpen:function(e){},onClick:function(e){},onHover:function(e){},onInit:function(e){},onRefresh:function(e){}},c=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,c.prototype,{constructor:c,VERSION:"3.4.0",newMenu:null,init:function(){var t=this,i=t.options,s=e.extend(!0,{},i,{open:function(s){t.openSubMenu(s.item),e.isFunction(i.onOpen)&&i.onOpen(e(s.item))}});try{t.newMenu=this.$element.kendoMenu(s).data("kendoMenu"),t.refreshMenu(function(){r(t),e.isFunction(s.onInit)&&s.onInit(t.$element)})}catch(t){return console.log(t),null}return t},refreshMenu:function(t){var i=this,s=i.options;return s.localData?(i.renderMenu(s.localData.data),e.isFunction(t)&&t(),e.isFunction(s.onRefresh)&&s.onRefresh(i.$element)):s.getData(s.url,s.ajax,function(n,a,o){i.renderMenu(n),e.isFunction(t)&&t(),e.isFunction(s.onRefresh)&&s.onRefresh(i.$element)}),this},renderMenu:function(t){var i=a(t,this.options,!0),s=this.newMenu;return s.remove(e("li",e("li[data-main]",s.element))).append(i,e("li[data-main]",s.element)),e("li[data-main]",s.element).data("main","true"),this},openSubMenu:function(t){var i=this,n=i.options,o=e(t),r=o.children("span").children("a");if(o.data("main")!=s&&0==o.data("main"))return n.getData(n.url,n.ajax,function(e,t,s){var r=a(e,n,!0);i.newMenu.append(r,o)}),o.data("main","true"),r.data("loaded","true"),i;if(r.data("loaded")!=s&&0==r.data("loaded")){var d=r.data("submenuUrl");if(!d)return r.data("loaded","true"),i;n.getData(d,n.ajax,function(e,t,s){var r=a(e,n,!1);i.newMenu.append(r,o)}),r.data("loaded","true")}}}),e.fn.udeskNewMenu=function(t){var i=e.extend(!0,{},e.fn.udeskNewMenu.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskNewMenu")||t.data("udeskNewMenu",new e.fn.udeskNewMenu.constructor(t,i))})},e.fn.udeskNewMenu.defaults=l,e.fn.udeskNewMenu.constructor=c})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t){return e(t).length>0}function a(t,i){return e.isFunction(i)?i(t):(h.error("菜单项模板方法错误"),s)}function o(t,i,s,n){var a=e.extend(!0,{},i,{success:function(t,i,n){e.isFunction(s)&&s(t,i,n)},error:function(t,i,s){e.isFunction(n)&&n(t,i,s)}});e.isFunction(h.ajax)?h.ajax(t,a):e.isFunction(e.ajax)?e.ajax(a):console.error("未找到ajax方法定义，加载树形菜单失败")}function r(t,s){var n=i.documentElement.clientHeight;return e(t).css({height:n-s})}function d(i,s,n,o){function d(t){t.localDataS.data=h(e(t.selector.sidWrapper));var i=e(".modal-body>ul",m),s=e(".modal-body>div",m);i.empty(),s.empty(),e(f.options.templates.containers).appendTo(s),i.append(a(t.localDataS.data,t.templates.modalItem))}function h(t){var i=t;if(i){var s,n=[],a=i.find("ul");try{a.length>0&&(s=a.eq(0).children("li"))}catch(t){}if(s&&0!=s.length){for(var o=0;o<s.length;o++){var r=e(s[o]),d={};n.push(d),d.menuId=u(r.data("menuId")),d.submenuUrl=u(r.data("submenuUrl")),d.sysId=u(r.data("sysId")),d.tabUrl=u(r.data("tabUrl")),d.tabMode=u(r.data("tabMode")),d.loaded=c(r.data("loaded"));var p=r.data("shortName");p||(p=r.children("a").eq(0).attr("title")),d.shortName=p;var f=r.attr("icon");f||(f=r.children("a").children("i").eq(0).attr("class")),d.icon=f.substring(13),d.items=null,l(r)&&(d.items=h(r))}return n}}}function p(t){for(var i=[],s=e(".modal-body>ul>li",m),n=0;n<s.length;n++){var a=e(s[n]),o={};o.menuId=a.data("menuId"),i.push(o)}var r={},d=[];r.data=d;for(var l=t.localDataS.data,n=0;n<i.length;n++)for(var c=i[n].menuId,u=0;u<l.length;u++){var h=l[u];if(c==h.menuId){d.push(h);break}}f.options.localData=r,f.refreshMenu()}var f=i,_=f.options;_.localDataS={};var m=(f.$element,f.options.selector,f.options.selector.treeMenu,e(f.options.templates.modalbox).appendTo("body"),e(_.selector.reorderModal));e(s,f.$element).on("click","li a",function(t){var i=e(this),s=i.parent();f.loadSubmenu(s,function(){f.toggleMenu(i,function(){e.isFunction(_.onClick)&&_.onClick(s)})})}),e(s,f.$element).on("mouseover","li a",function(t){e.isFunction(_.onMouseover)&&_.onMouseover(e(this).parent())}),e(t).resize(function(){r(_.selector.mainRoot,_.heightReduced)}),m.on("show.bs.modal",function(e){d(_)}),e(_.selector.choiceBtnYES,m).on("click",function(){p(_)})}function l(e){if(!e)return!1;var t=e.children("ul");return!!t&&t.length>0}function c(e){return!(!e||0==e.length)&&"true"==e}function u(e){return e&&0!=e.length?"null"==e.toLowerCase()?null:e:null}var h=t.udesk=t.udesk||{},p={localData:s,url:s,ajax:{},getData:o,templates:{modalItem:h.template?h.template('{{var data=it; for(var i=0;i<data.length;i++){ }}<li class="treeview" data-menu-id="{{=data[i].menuId}}" data-sys-id="{{=data[i].sysId}}"  data-submenu-url="{{=data[i].submenuUrl}}" data-tab-url="{{=data[i].tabUrl}}" data-tab-mode="{{=data[i].tabMode}}"  data-loaded="{{=data[i].loaded}}"  data-short-name="{{=data[i].shortName}}"><span class="fa fa-reorder"></span>{{=data[i].shortName}}</li>{{ } }}'):s,menuItem:h.template?h.template('{{var data=it; for(var i=0;i<data.length;i++){ }}<li class="treeview" {{ if(data[i].pinyin){ }}data-pinyin="{{=data[i].pinyin}}"{{ } }} data-menu-id="{{=data[i].menuId}}" data-sys-id="{{=data[i].sysId}}" data-submenu-url="{{= data[i].submenuUrl}}" data-tab-url="{{= data[i].tabUrl}}" data-tab-mode="{{=data[i].tabMode}}" data-loaded="false"> <a title="{{=data[i].shortName}}"><i class="icon-sidebar {{=data[i].icon}}"></i><span data-treemenu-type="title" {{if(data[i].counterUrl){ }}class="u-with-counter"{{ } }}>{{=data[i].shortName}}</span>{{if(data[i].counterUrl){ }} <i class="u-treemenu-counter" data-url="{{=data[i].counterUrl}}"></i>{{ } }} {{if(data[i].submenuUrl||data[i].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a>{{if(data[i].items) {var sdata=data[i].items;}}<ul class="treeview-menu" style="display:none;"> {{for(var j=0;j<sdata.length;j++){ }} <li {{ if(sdata[j].pinyin){ }}data-pinyin="{{=sdata[j].pinyin}}"{{ } }}  data-menu-id="{{=sdata[j].menuId}}" data-sys-id="{{=sdata[j].sysId}}" data-submenu-url="{{=sdata[j].submenuUrl}}" data-tab-url="{{=sdata[j].tabUrl}}" data-tab-mode="{{=sdata[j].tabMode}}" data-loaded="false"> <a title="{{=sdata[j].shortName}}"><i class="icon-sidebar {{=sdata[j].icon}}"></i><span data-treemenu-type="title" {{if(sdata[j].counterUrl){ }}class="u-with-counter"{{ } }}>{{=sdata[j].shortName}}</span>{{if(sdata[j].counterUrl){ }} <i class="u-treemenu-counter" data-url="{{=sdata[j].counterUrl}}"></i>{{ } }} {{if(sdata[j].submenuUrl||sdata[j].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a>{{if(sdata[j].items){var ssdata=sdata[j].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var k=0;k<ssdata.length;k++){ }} <li {{ if(ssdata[k].pinyin){ }}data-pinyin="{{=ssdata[k].pinyin}}"{{ } }}  data-menu-id="{{=ssdata[k].menuId}}" data-sys-id="{{=ssdata[k].sysId}}" data-submenu-url="{{=ssdata[k].submenuUrl}}" data-tab-url="{{=ssdata[k].tabUrl}}" data-tab-mode="{{=ssdata[k].tabMode}}" data-loaded="false"> <a title="{{=ssdata[k].shortName}}"><i class="icon-sidebar {{=ssdata[k].icon}}"></i><span data-treemenu-type="title" {{if(ssdata[k].counterUrl){ }}class="u-with-counter"{{ } }}>{{=ssdata[k].shortName}}</span>{{if(ssdata[k].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=ssdata[k].counterUrl}}"></i>{{ } }} {{if(ssdata[k].submenuUrl||ssdata[k].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(ssdata[k].items){var sssdata=ssdata[k].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var l=0;l<sssdata.length;l++){ }} <li {{ if(sssdata[l].pinyin){ }}data-pinyin="{{=sssdata[l].pinyin}}"{{ } }} data-menu-id="{{=sssdata[l].menuId}}" data-sys-id="{{=sssdata[l].sysId}}" data-submenu-url="{{=sssdata[l].submenuUrl}}" data-tab-url="{{=sssdata[l].tabUrl}}" data-tab-mode="{{=sssdata[l].tabMode}}" data-loaded="false"> <a title="{{=sssdata[l].shortName}}"><i class="icon-sidebar {{=sssdata[l].icon}}"></i><span data-treemenu-type="title" {{if(sssdata[l].counterUrl){ }}class="u-with-counter"{{ } }}>{{=sssdata[l].shortName}}</span>{{if(sssdata[l].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=sssdata[l].counterUrl}}"></i>{{ } }} {{if(sssdata[l].submenuUrl||sssdata[l].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(sssdata[l].items){var ssssdata=sssdata[l].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var m=0;m<ssssdata.length;m++){ }} <li {{ if(ssssdata[m].pinyin){ }}data-pinyin="{{=ssssdata[m].pinyin}}"{{ } }} data-menu-id="{{=ssssdata[m].menuId}}" data-sys-id="{{=ssssdata[m].sysId}}" data-submenu-url="{{=ssssdata[m].submenuUrl}}" data-tab-url="{{=ssssdata[m].tabUrl}}" data-tab-mode="{{=ssssdata[m].tabMode}}" data-loaded="false"> <a title="{{=ssssdata[m].shortName}}"><i class="icon-sidebar {{=ssssdata[m].icon}}"></i><span data-treemenu-type="title" {{if(ssssdata[m].counterUrl){ }}class="u-with-counter"{{ } }}>{{=ssssdata[m].shortName}}</span>{{if(ssssdata[m].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=ssssdata[m].counterUrl}}"></i>{{ } }} {{if(ssssdata[m].submenuUrl||ssssdata[m].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }}'):s,submenuItem:h.template?h.template('<ul class="treeview-menu" style="display:none;" > {{var data=it; for(var i=0;i<data.length;i++){ }} <li {{ if(data[i].pinyin){ }}data-pinyin="{{=data[i].pinyin}}"{{ } }} data-menu-id="{{=data[i].menuId}}" data-sys-id="{{=data[i].sysId}}" data-submenu-url="{{=data[i].submenuUrl}}" data-tab-url="{{=data[i].tabUrl}}" data-tab-mode="{{=data[i].tabMode}}" data-loaded="false"> <a title="{{=data[i].shortName}}"><i class="icon-sidebar {{=data[i].icon}}"></i><span data-treemenu-type="title" {{if(data[i].counterUrl){ }}class="u-with-counter"{{ } }}>{{=data[i].shortName}}</span>{{if(data[i].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=data[i].counterUrl}}"></i>{{ } }} {{if(data[i].submenuUrl||data[i].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(data[i].items) {var sdata=data[i].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var j=0;j<sdata.length;j++){ }} <li {{ if(sdata[j].pinyin){ }}data-pinyin="{{=sdata[j].pinyin}}"{{ } }} data-menu-id="{{=sdata[j].menuId}}" data-sys-id="{{=sdata[j].sysId}}" data-submenu-url="{{=sdata[j].submenuUrl}}" data-tab-url="{{=sdata[j].tabUrl}}" data-tab-mode="{{=sdata[j].tabMode}}" data-loaded="false"> <a title="{{=sdata[j].shortName}}"><i class="icon-sidebar {{=sdata[j].icon}}"></i><span data-treemenu-type="title" {{if(sdata[j].counterUrl){ }}class="u-with-counter"{{ } }}>{{=sdata[j].shortName}}</span>{{if(sdata[j].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=sdata[j].counterUrl}}"></i>{{ } }} {{if(sdata[j].submenuUrl||sdata[j].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(sdata[j].items){var ssdata=sdata[j].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var k=0;k<ssdata.length;k++){ }} <li {{ if(ssdata[k].pinyin){ }}data-pinyin="{{=ssdata[k].pinyin}}"{{ } }} data-menu-id="{{=ssdata[k].menuId}}" data-sys-id="{{=ssdata[k].sysId}}" data-submenu-url="{{=ssdata[k].submenuUrl}}" data-tab-url="{{=ssdata[k].tabUrl}}" data-tab-mode="{{=ssdata[k].tabMode}}" data-loaded="false"> <a title="{{=ssdata[k].shortName}}"><i class="icon-sidebar {{=ssdata[k].icon}}"></i><span data-treemenu-type="title" {{if(ssdata[k].counterUrl){ }}class="u-with-counter"{{ } }}>{{=ssdata[k].shortName}}</span>{{if(ssdata[k].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=ssdata[k].counterUrl}}"></i>{{ } }} {{if(ssdata[k].submenuUrl||ssdata[k].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(ssdata[k].items){var sssdata=ssdata[k].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var l=0;l<sssdata.length;l++){ }} <li {{ if(sssdata[l].pinyin){ }}data-pinyin="{{=sssdata[l].pinyin}}"{{ } }} data-menu-id="{{=sssdata[l].menuId}}" data-sys-id="{{=sssdata[l].sysId}}" data-submenu-url="{{=sssdata[l].submenuUrl}}" data-tab-url="{{=sssdata[l].tabUrl}}" data-tab-mode="{{=sssdata[l].tabMode}}" data-loaded="false"> <a title="{{=sssdata[l].shortName}}"><i class="icon-sidebar {{=sssdata[l].icon}}"></i><span data-treemenu-type="title" {{if(sssdata[l].counterUrl){ }}class="u-with-counter"{{ } }}>{{=sssdata[l].shortName}}</span>{{if(sssdata[l].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=sssdata[l].counterUrl}}"></i>{{ } }} {{if(sssdata[l].submenuUrl||sssdata[l].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> {{if(sssdata[l].items){var ssssdata=sssdata[l].items;}} <ul class="treeview-menu" style="display:none;"> {{for(var m=0;m<ssssdata.length;m++){ }} <li {{ if(ssssdata[m].pinyin){ }}data-pinyin="{{=ssssdata[m].pinyin}}"{{ } }} data-menu-id="{{=ssssdata[m].menuId}}" data-sys-id="{{=ssssdata[m].sysId}}" data-submenu-url="{{=ssssdata[m].submenuUrl}}" data-tab-url="{{=ssssdata[m].tabUrl}}" data-tab-mode="{{=ssssdata[m].tabMode}}" data-loaded="false"> <a title="{{=ssssdata[m].shortName}}"><i class="icon-sidebar {{=ssssdata[m].icon}}"></i><span data-treemenu-type="title" {{if(ssssdata[m].counterUrl){ }}class="u-with-counter"{{ } }}>{{=ssssdata[m].shortName}}</span>{{if(ssssdata[m].counterUrl){ }}<i class="u-treemenu-counter" data-url="{{=ssssdata[m].counterUrl}}"></i>{{ } }} {{if(ssssdata[m].submenuUrl||ssssdata[m].items){ }}<i class="icon-menu-expand"></i>{{ } }}</a> </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul> {{ } }} </li> {{ } }} </ul>'):s,reducedmenuItem:kendo.template?kendo.template('# for(var i=0;i<data.length;i++){ #<li class="clearfix" data-sys-id="#=data[i].sysId#" data-submenu-url="#= data[i].submenuUrl#" data-tab-url="#=data[i].tabUrl#" data-tab-mode="#=data[i].tabMode#" data-title="#= data[i].shortName#" data-loaded="false"><i class="icon-sidebar #=data[i].icon#"></i> </li># } #'):s,modalbox:'<div class="modal fade u-treemenu-modal"  tabindex="-1" role="dialog" aria-labelledby="udeskModalLabel" style="padding-right: 17px;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button><h4 class="modal-title"><i class="fa fa-sort-amount-asc" style="margin-right:5px"></i><b>自定义菜单顺序</b></h4></div><div class="modal-body"><div class="divBox"></div><ul></ul></div><div class="modal-footer"><button type="button" class="btn active btn-theme choice-btn-yes" data-dismiss="modal" data-code="YES">保存(Y)</button><button type="button" class="btn choice-btn-no" data-dismiss="modal" data-code="NO">取消(N)</button></div></div></div></div>',containers:'<p class="prompt">请使用鼠标拖拽完成菜单排序，点击“保存”按钮提交排序结果:</p>'},selector:{wrapper:".main-sidebar",mainRoot:"#mainSideBarMenu",reducedRoot:"#reducedSideBarMenu",treeMenu:".treeview-menu",gradeOneItem:".treeview",indexItem:'li[data-treemenu-role="index"]',expandIcon:"icon-menu-expand",loadingIcon:"icon-loadingimg",sidWrapper:".sidebar",reorderModal:".u-treemenu-modal",choiceBtnYES:".choice-btn-yes",counter:".u-treemenu-counter"},speed:200,heightReduced:50,counter:{ajax:{},done:function(e,t,i,s){s.text(e).addClass("loaded")},fail:function(e,t,i,s){}},onInit:function(e){},onClick:function(e){},onMouseover:function(e){},onRefresh:function(e){},onCounterBind:function(e,t){}},f=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,f.prototype,{constructor:f,VERSION:"3.4.0",init:function(){var t=this,i=t.options,s=i.selector;return e(s.mainRoot,t.$element).length||e("<ul/>",{'class':"sidebar-menu",id:s.mainRoot.slice(1,s.mainRoot.length)}).appendTo(t.$element),t.refreshMenu(function(){r(i.selector.mainRoot,i.heightReduced),d(t,s.mainRoot,s.reducedRoot,i.speed),e.isFunction(i.onInit)&&i.onInit(e(s.mainRoot,t.$element).children().first())}),t},refreshMenu:function(t){var i=this,s=i.options,n=i.$element;return s.localData?i.renderMenu(s.localData.data,function(){e.isFunction(t)&&t(n),e.isFunction(s.onRefresh)&&s.onRefresh(n)}):s.url&&s.getData(s.url,s.ajax,function(a,o,r){i.renderMenu(a,function(){e.isFunction(t)&&t(n),e.isFunction(s.onRefresh)&&s.onRefresh(n)})}),i},loadSubmenu:function(t,i){var s=this,n=s.options,a=n.selector,o=a.expandIcon,r=a.loadingIcon,d=t.data("submenuUrl"),l=t.children("a"),c=t.data("loaded");return"loading"!=c&&("true"==c||1==c?(e.isFunction(i)&&i(t),s):d?(t.data("loaded","loading"),l.find("."+o).length?l.find("."+o).first().removeClass(o).addClass(r).html("    ").siblings("."+o).remove():l.find("."+r).length?l.find("."+r).first().siblings("."+r).remove():l.children("span").after('<i class="'+r+'">    </i>'),n.getData(d,n.ajax,function(n,a,d){t.children("a").find("."+r).first().removeClass(r).addClass(o).siblings("."+r).remove(),t.data("loaded",!0),s.renderSubmenu(n,t),e.isFunction(i)&&i(n,a,d)},function(e,i,s){t.data("loaded",!1)}),s):(e.isFunction(i)&&i(t),s))},loadSubmenuById:function(t,i){return this.loadSubmenu(e(e('[data-menu-id="'+t+'"]',this.$element)[0]),i)},loadSubmenuByTitle:function(t,i){return this.loadSubmenu(e(e('a[title="'+t+'"]',this.$element)[0]).parent(),i)},renderMenu:function(t,i){var s=this,o=s.options,r=o.selector,d=e(r.mainRoot,s.$element),l=(e(r.redocedRoot,s.$element),r.indexItem),c=o.templates;return o.speed,n(d.children(l))?(d.children(l).siblings().remove(),d.append(a(t,c.menuItem))):d.empty().append(a(t,c.menuItem)),e(r.counter,e.mainRoot).each(function(){var t=e(this);e.isFunction(o.onCounterBind)&&o.onCounterBind(s,t),h.ajax(e.extend(!0,{url:t.data("url"),context:t},o.counter.ajax)).done(o.counter.done).fail(o.counter.fail)}),e.isFunction(i)&&i(),s},renderSubmenu:function(t,i,s){var n=this,o=n.options;e(i,n.$element).find(o.selector.treeMenu).remove();var r=a(t,o.templates.submenuItem);return e(i,n.$element).append(r),e(o.selector.counter,i).each(function(){var t=e(this);e.isFunction(o.onCounterBind)&&o.onCounterBind(n,t),h.ajax(e.extend(!0,{url:t.data("url"),context:t},o.counter.ajax)).done(o.counter.done).fail(o.counter.fail)}),e.isFunction(s)&&s(),n},renderSubmenuById:function(t,i,s){return this.renderSubmenu(t,e(e('[data-menu-id="'+i+'"]',this.$element)[0]),s)},renderSubmenuByTitle:function(t,i,s){return this.renderSubmenu(t,e(e('a[title="'+i+'"]',this.$element)[0]).parent(),s)},openMenu:function(t,i){var s=this,n=this.options,a=n.selector,o=a.treeMenu,r=n.speed,d=t.parent(),l=t.parentsUntil(a.gradeOneClass,o),c=function(t,i){var n=t.parent(),a=t.children(o);t.hasClass("active")?(a.find(".active").removeClass("active"),e.isFunction(i)&&i()):(n.children().each(function(){e(this).removeClass("active").find(o+".menu-open").removeClass("menu-open").stop(!0).slideUp(r,function(){e(this).find(".active").removeClass("active")})}),t.addClass("active"),a.length?a.is(":visible")?(a.find(".active").removeClass("active"),e.isFunction(i)&&i()):a.stop(!0).slideDown(r,function(){a.addClass("menu-open"),e.isFunction(i)&&i()}):t.data("submenuUrl")?s.loadSubmenu(t,function(){t.children("ul").stop(!0).slideDown(r,function(){e(this).addClass("menu-open"),e.isFunction(i)&&i()})}):(t.addClass("active"),e.isFunction(i)&&i()))},u=function(t,s){if(s<0||!t[s])return void c(d,i);e(t[s]).is(":visible")?u(t,s-1):c(e(t[s].parentNode),function(){u(t,s-1)})};return u(l,l.length-1),s},openMenuById:function(t,i){return this.openMenu(e(e('[data-menu-id="'+t+'"] > a',this.$element)[0]),i)},openMenuByTitle:function(t,i){return this.openMenu(e(e('a[title="'+t+'"]',this.$element)[0]),i)},closeMenu:function(t,i){var s=this,n=this.options,a=n.speed;return t.parent().removeClass("active").find(n.selector.treeMenu+".menu-open").stop(!0).removeClass("menu-open").slideUp(a,function(){e(this).children(".active").removeClass("active"),e.isFunction(i)&&i()}),s},closeMenuById:function(t,i){return this.closeMenu(e(e('[data-menu-id="'+t+'"] > a',this.$element)[0]),i)},closeMenuByTitle:function(t,i){return this.closeMenu(e(e('a[title="'+t+'"]',this.$element)[0]),i)},toggleMenu:function(e,t){var i=this.options.selector.treeMenu,s=e.siblings(i);return s.is(i)&&s.is(":visible")?this.closeMenu(e,t):this.openMenu(e,t)},toggleMenuById:function(t,i){return this.toggleMenu(e(e('[data-menu-id="'+t+'"] > a',this.$element)[0]),i)},toggleMenuByTitle:function(t,i){return this.toggleMenu(e(e('a[title="'+t+'"]',this.$element)[0]),i)},dragGradeOneItem:function(){var t=this,i=t.options,s=i.selector;return t._KendoSortable=e(s.mainRoot).kendoSortable({filter:s.gradeOneItem,disabled:".dragDestroy",axis:"y",cursor:"move",container:s.wrapper,hint:function(t){return e('<ul class="sidebar-menu hint" style="width:232px;background-color:#fff;"><li class="treeview" style="border:1px solid #d2d6de;">'+t.html()+"</li></ul>")}}).data("kendoSortable"),t}}),e.fn.udeskTreeMenu=function(t){var i=e.extend(!0,{},e.fn.udeskTreeMenu.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskTreeMenu")||t.data("udeskTreeMenu",new e.fn.udeskTreeMenu.constructor(t,i))})},e.fn.udeskTreeMenu.defaults=p,e.fn.udeskTreeMenu.constructor=f})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t){var i=t,s=i.autoComplete,n=i.options,a=i.$element,o=n.target.$element;return s.bind("select",function(t){this.shortName=t.item.text();var i=e(t.item).children("span");n.target.openMenuByTitle(i.data("tabTitle"),function(){e.isFunction(n.onSelect)&&n.onSelect(i)})}),s.bind("change",function(t){this.value(this.shortName),e.isFunction(n.onChange)&&n.onChange(t)}),s.bind("close",function(t){e.isFunction(n.onClose)&&n.onClose(t)}),s.bind("dataBound",function(t){e.isFunction(n.onDataBound)&&n.onDataBound(t)}),s.bind("filtering",function(t){e.isFunction(n.onFiltering)&&n.onFiltering(t)}),s.bind("open",function(t){e.isFunction(n.onOpen)&&n.onOpen(t)}),a.on("focus",function(){var t,s,r,d,l=e('[data-treemenu-type="title"]',o),c=[];for(d=0;d<l.length;d++){for(t=e(l[d]).closest("li"),s=t,r="";!s.hasClass("treeview");)s=s.parent().closest("li"),r=s.children("a").children("span").text()+" / "+r;c[d]={shortName:e(l[d]).text(),parentName:r,pinyin:t.data("pinyin"),alias:r+l[d].innerText+t.data(n.dataAliasField),menuId:t.data("menuId"),sysId:t.data("sysId"),tabUrl:t.data("tabUrl")}}var u=e.extend(!0,{},n.dataSource,{data:c});if(i.autoComplete)try{i.autoComplete.setDataSource(new kendo.data.DataSource(u))}catch(t){console.log(t)}e.isFunction(n.onFocus)&&n.onFocus(a)}),a.on("click",function(){e.isFunction(n.onClick)&&n.onClick(a)}),i}var a=(t.udesk=t.udesk||{},"udeskMenuSearch"),o={target:null,dataSource:{data:null,schema:{model:{id:"shortName",fields:{shortName:{type:"string",defaultValue:null},pinyin:{type:"string",defaultValue:null},alias:{type:"string",defaultValue:null},parentName:{type:"string",defaultValue:null},sysId:{type:"string",defaultValue:null},menuId:{type:"string",defaultValue:null},submenuUrl:{type:"string",defaultValue:null},tabUrl:{type:"string",defaultValue:null},targetA:{type:"object",defaultValue:null}}}}},dataTextField:"alias",dataAliasField:"pinyin",filter:"contains",placeholder:"请输入菜单项名称",highlightFirst:!0,delay:100,template:'<span #if(pinyin){# data-pinyin="#:pinyin#" #}# data-menu-id="#:menuId#" data-sys-id="#:sysId#" data-tab-url="#:tabUrl#" data-tab-title="#:shortName#">#if(parentName){##:parentName##}##:shortName#</span>',onInit:function(e){},onFocus:function(e){},onClick:function(e){},onSelect:function(e){},onChange:function(e){},onClose:function(e){},onDataBound:function(e){},onFiltering:function(e){},onOpen:function(e){}},r=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,r.prototype,{constructor:r,VERSION:"3.4.0",dataSource:null,autoComplete:null,init:function(){var t,i=this,s=i.options;s.selector;try{i.dataSource=new kendo.data.DataSource(s.dataSource),t=e.extend(!0,{},s,{dataSource:i.dataSource}),i.autoComplete=i.$element.kendoAutoComplete(t).data("kendoAutoComplete")}catch(t){return console.log(t),null}return n(i),e.isFunction(s.onInit)&&s.onInit(i.$element),i}}),e.fn[a]=function(t){var i=e.extend(!0,{},e.fn[a].defaults,t);return this.each(function(){var t=e(this);e(this).data(a)||t.data(a,new e.fn[a].constructor(t,i))})},e.fn[a].defaults=o,e.fn[a].constructor=r})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t,i,s){var n=e.extend(!0,{},{success:function(t,i,n){e.isFunction(s)&&s(t,i,n)}},i);try{e.isFunction(r.ajax)?r.ajax(t,n):e.isFunction(e.ajax)?e.ajax(n):console.error("未找到ajax方法定义，加载侧边栏菜单失败")}catch(t){console.error(t)}}function a(t,s){var n=i.documentElement.clientHeight;return e(t).css({height:n-s,position:"relative"})}function o(i){var n=i,o=n.$element,r=n.options,d=n.options.selector;return e(d.headerRoot,o).on("click","li",function(){var t=parseInt(e(this).data("tabId"));n.changeTab(t),e.isFunction(r.onClick)&&r.onClick(e(this))}),e(d.headerRoot,o).on("hover","li",function(){e.isFunction(r.onHover)&&r.onHover(e(this))}),e(d.headerRoot,o).on("click",".tab-close",function(t){t.stopPropagation();var i=parseInt(e(this).closest("li").data("tabId"));n.closeTab(i)}),e(d.headerRoot,o).on("click",".tab-refresh",function(t){t.stopPropagation();var i=parseInt(e(this).closest("li").data("tabId"));n.changeTab(i),n.refreshTab(i)}),e(t).resize(function(){n.adjustTabsWidth(),a(d.wrapper,r.heightReduced)}),e(d.closeRoot).on("click",".tab-close-other",function(){n.closeOtherTab()}),e(d.closeRoot).on("click",".tab-close-all",function(){n.closeAllTab()}),e(d.closeRoot).on("click",".tab-close-current",function(){var t=e(d.headerRoot).find(".pr.active").data("tabId"),i=s;n.closeTab(t,i)}),n}var r=t.udesk=t.udesk||{},d={closeConfirm:{title:"关闭确认",message:null,messageCloseAll:"确定要关闭全部页签吗?",messageCloseOther:"确定要关闭其它页签吗?",choice:[{display:"是(Y)",code:"YES"},{display:"否(N)",code:"NO"}]},showCloseConfirm:!1,loadingMask:{color:"#FFFFFF",template:'<div class="u-loadingmask"><a class="u-loadingimg"></a></div>',fadeSpeed:500},localData:s,url:"",ajax:{},getData:n,maxTabs:15,isIndexFixed:!1,dataBase:{data:s,schema:{model:{id:"idx",fields:{url:{type:"string"},idx:{type:"number",defaultValue:null},title:{type:"string",defaultValue:"新标签页"},menuId:{type:"string",defaultValue:null},sysId:{type:"string",defaultValue:null},mode:{type:"string",defaultValue:"iframe"},tdId:{type:"string",defaultValue:null},sndUrl:{type:"string",defaultValue:null}}}}},tabWidth:125,tabMarginR:10,heightReduced:50,showRefreshButton:!1,templates:{header:kendo.template?kendo.template('<li data-tab-id="#=idx#" class="pr" title="#=title#"><a title="#=title#"><span>#=title#</span></a><a class="icon-remove tab-close"></a></li>'):s,headerRefresh:kendo.template?kendo.template('<li data-tab-id="#=idx#" class="pr" title="#=title#"><a title="#=title#"><span>#=title#</span></a><a class="icon-repeat tab-refresh"></a><a class="icon-remove tab-close"></a></li>'):s,content:kendo.template?kendo.template('<div class="tab-content-wrapper pr hidden" data-tab-id="#=idx#"></div>'):s,contentDiv:kendo.template?kendo.template('<div class="udesk-tab-div"><div>'):s,contentIframe:kendo.template?kendo.template('<iframe src="#=url#" name="udesk-tab-iframe-#=idx#" frameborder="no" height="100%" width="100%"></iframe>'):s,rightClickMenu:'<ul class="udesk-tab-context-menu" style="width:auto"><li class="tab-close-current"><span class="fa fa-close"></span>关闭当前页签</li><li class="tab-close-all"><span class="fa fa-ban"></span>关闭所有页签</li><li class="tab-close-other"><span class="fa fa-times-circle"></span>关闭其他页签</li></ul>'},selector:{wrapper:".content-wrapper",headerRoot:"ul.tabsite",contentRoot:"#mainApplyContent",sidebar:".main-sidebar",closeRoot:".udesk-tab-context-menu",header:".content-header"},onInit:function(e){},onTabCreate:function(e){},onTabOpen:function(e){},onTabChange:function(e){},onTabClose:function(e){},onClick:function(e){},onHover:function(e){},onTabsFull:function(e){},onTabRefresh:function(e){},onTabRefreshed:function(e){}},l=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,l.prototype,{constructor:l,VERSION:"3.4.0",currentTabIdx:0,tabsCount:0,dataSource:s,init:function(){var t=this,i=t.options,s=i.selector;a(i.selector.wrapper,i.heightReduced);try{t.dataSource=new kendo.data.DataSource(i.dataBase),t.dataSource.sort({field:"idx",dir:"asc"})}catch(t){console.error(t)}t.tabsCount=i.isIndexFixed?t.getDisplayCount()-1:t.getDisplayCount(),e(s.header,t.$element).after(i.templates.rightClickMenu),e(s.closeRoot,t.$element).kendoContextMenu({target:s.header,animation:{open:{effects:"fadeIn",duration:100}}}),o(t),e.isFunction(i.onInit)&&i.onInit(t);try{e(s.headerRoot,t.$element).kendoSortable({filter:">li",axis:"x",container:s.headerRoot,hint:function(t){var i=t.attr("style");return e('<div id="hint" style="padding:0;" class="content-header"><ul class="tabsite  clearfix"><li class="pr active" style="'+i+'box-shadow:none !important;">'+t.html()+"</li></ul></div>")},start:function(i){var s=i.item,n=s.data("tab-id");e('li[data-tab-id="'+n+'"]',t.$element).addClass("active").siblings(".active").removeClass("active"),e('div[data-tab-id="'+n+'"]',t.$element).removeClass("hidden").siblings().addClass("hidden"),t.currentTabIdx=n}}).data("kendoSortable")}catch(t){console.error(t)}return t},getDisplayCount:function(){return this.dataSource.data().length},changeTab:function(t){var i=this,s=i.options,n=i.options.selector;return t==i.currentTabIdx||(e('li[data-tab-id="'+t+'"]',n.headerRoot).addClass("active").siblings(".active").removeClass("active"),e('div[data-tab-id="'+t+'"]',n.contentRoot).removeClass("hidden").siblings().addClass("hidden"),i.currentTabIdx=t,e.isFunction(s.onTabChange)&&s.onTabChange(i.$element)),i},createTab:function(t){var i=this,s=(i.$element,i.options),n=s.templates,a=s.selector,o=(s.showRefreshButton?e(n.headerRefresh(t)).appendTo(a.headerRoot):e(n.header(t)).appendTo(a.headerRoot),e(n.content(t)).appendTo(a.contentRoot));try{var r=o.udeskLoadingMask(s.loadingMask).data("udeskLoadingMask")}catch(t){console.error(t)}return t.mode&&"div"==t.mode?s.getData(t.url,s.ajax,function(a,d,l){e(n.contentDiv(t)).append(a).appendTo(o),r&&r.removeMask(),e.isFunction(s.onTabCreate)&&s.onTabCreate(i.$element)}):e(n.contentIframe(t)).load(function(){t.sndUrl&&"null"!=t.sndUrl?(e(this).unbind(""),e(this)[0].onload=function(){r&&r.removeMask()},e(this).prop("src",t.sndUrl)):(r&&r.removeMask(),e.isFunction(s.onTabCreate)&&s.onTabCreate(i.$element))}).appendTo(o),i.adjustTabsWidth(),i},openTab:function(t){var i=this,s=i.options;i.dataSource.filter({field:"url",operator:"eq",value:t.url});var n=i.dataSource.view(),a=null;if(n.length<=0){if(i.getDisplayCount()>=s.maxTabs)return e.isFunction(s.onTabsFull)&&s.onTabsFull(i),i;t.idx=i.tabsCount+=1,t.sysId=t.sysId||"",a=i.dataSource.add(t),i.createTab(a)}else a=i.dataSource.get(n[0].idx);return e.isFunction(s.onTabOpen)&&s.onTabOpen(i.$element),i.changeTab(a.idx),i},adjustTabsWidth:function(){var t,i,s=this,n=s.$element,a=s.options,o=s.options.selector,r=e(o.headerRoot,n),d=(e(o.sidebar,n),r[0].offsetWidth),l=s.getDisplayCount();return d>l*(a.tabWidth-2+a.tabMarginR)?(t=a.tabWidth-2,i=a.tabMarginR):(t=d/l-3,i=1),e("li[data-tab-id]",o.headerRoot).width(t).css("marginRight",i),s},closeTab:function(i,n){function a(){if(i==s&&(i=o.currentTabIdx),0==i&&1==l.isIndexFixed);else{i==o.currentTabIdx&&(e('li[data-tab-id="'+i+'"]',d).siblings().length>0?(u=e('li[data-tab-id="'+i+'"]',d).next().length>0?parseInt(e('li[data-tab-id="'+i+'"]',d).next().data("tabId")):parseInt(e('li[data-tab-id="'+i+'"]',d).prev().data("tabId")),o.changeTab(u),o.currentTabIdx=u):o.currentTabIdx=null);var n=e('div[data-tab-id="'+i+'"]',c.contentRoot).find("iframe");n.length>0&&(n[0].src="about:blank",e('div[data-tab-id="'+i+'"]',c.contentRoot).remove("iframe"),n[0]=null,t.CollectGarbage&&CollectGarbage()),e('div[data-tab-id="'+i+'"]',c.contentRoot).remove(),e('li[data-tab-id="'+i+'"]',c.headerRoot).remove(),o.dataSource.remove(o.dataSource.get(i)),o.adjustTabsWidth()}e.isFunction(l.onTabClose)&&l.onTabClose(d)}var o=this,d=o.$element,l=o.options,c=o.options.selector,u=0;this.dataSource.filter({field:"idx",operator:"eq",value:i});var h=this.dataSource.view(),p=h.length>0?h[0]:null;1!=l.showCloseConfirm||0!=n&&n!=s?a():r.confirm({title:l.closeConfirm.title,message:l.closeConfirm.message||"确定要关闭页签“"+p.title+"”吗?",choice:l.closeConfirm.choice,defaultChoice:l.closeConfirm.defaultChoice,confirmCallback:function(e){if("YES"!=e)return o;a()}})},closeAllTab:function(){function t(){var t=[];t=e(i.options.selector.headerRoot,i.$element).find("li");for(var s=0;s<t.length;s++){var n=e(t[s]).data("tabId");1==i.options.isIndexFixed&&0==t[s]||i.closeTab(n,!0)}}var i=this,s=(i.$element,i.options);return i.options.selector,1==i.options.showCloseConfirm?r.confirm({title:s.closeConfirm.title,message:s.closeConfirm.messageCloseAll,choice:s.closeConfirm.choice,defaultChoice:s.closeConfirm.defaultChoice,confirmCallback:function(e){"YES"==e&&t()}}):t(),i},closeOtherTab:function(){function t(){var t=[];t=e(i.options.selector.headerRoot,i.$element).find("li");for(var s=i.currentTabIdx,n=0;n<t.length;n++){var a=e(t[n]).data("tabId");1==i.options.isIndexFixed&&0==t[n]||s!=a&&i.closeTab(a,!0)}}var i=this,s=(i.$element,i.options);return i.options.selector,1==i.options.showCloseConfirm?r.confirm({title:s.closeConfirm.title,message:s.closeConfirm.messageCloseOther,choice:s.closeConfirm.choice,defaultChoice:s.closeConfirm.defaultChoice,confirmCallback:function(e){"YES"==e&&t()}}):t(),i},refreshTab:function(t){var i=this,n=i.options;t==s&&(t=i.currentTabIdx);var a=e('div[data-tab-id="'+t+'"]',i.$element);if(!a||0==a.children("iframe").length)return null;e.isFunction(n.onTabRefresh)&&n.onTabRefresh(i.$element);try{var o=a.udeskLoadingMask(n.loadingMask).data("udeskLoadingMask")}catch(t){console.error(t)}o.isShown||o.addMask();var r=a.children("iframe");return r[0].onload=function(){o&&o.removeMask(),e.isFunction(n.onTabRefreshed)&&n.onTabRefreshed(i.$element)},r.attr("src",a.children("iframe").attr("src")),i}}),e.fn.udeskTab=function(t){var i=e.extend(!0,{},e.fn.udeskTab.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskTab")||t.data("udeskTab",new e.fn.udeskTab.constructor(t,i))})},e.fn.udeskTab.defaults=d,e.fn.udeskTab.constructor=l})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t,i,s){var n=e.extend(!0,{},{success:function(t,i,n){e.isFunction(s)&&s(t,i,n)}},i);e.isFunction(r.ajax)?r.ajax(t,n):e.isFunction(e.ajax)?e.ajax(n):console.error("未找到ajax方法定义，加载侧边栏菜单失败")}function a(t){var s=t,n=s.options,a=n.selector,o=e(n.selector.mainSidebar),r=i.documentElement.clientWidth,d=o.data(n.slideFlag),l=e(a.content),c=n.slideCss;r<n.toggleWidth&&(!0===d||"true"==d)?s.slideClose():r>n.toggleWidth&&(!0===d||"true"==d)&&l.stop(!0).animate(c[2],{queue:!1,duration:n.slideSpeed,easing:n.slideEasing})}function o(i){var s=i;return e(s.options.selector.toggle).click(function(){s.slideToggle()}),e(t).resize(function(){a(s)}),s}var r=t.udesk=t.udesk||{},d={localData:s,url:"",newMenu:{newMenu:null,localData:s,url:""},treeMenu:{treeMenu:null,localData:s,url:""},menuSearch:{menuSearch:null,target:null,onSelect:function(e){}},selector:{newMenu:"#newMenu",treeMenu:".sidebar",mainSidebar:".main-sidebar",reducedSidebar:".sidebar-reduced",menuSearch:"#menuSearcher",toggle:".sidebar-toggle",content:".content-wrapper"},ajax:null,getData:n,templates:null,toggleWidth:800,slideFlag:"slideOpen",slideCss:[{marginLeft:"-230px"},{marginLeft:"0"},{marginLeft:"230px"}],slideSpeed:200,slideEasing:"linear",onInit:function(e){},onRefreshAll:function(e){},onSlideToggle:function(e){},onSlideOpen:function(e){},onSlideClose:function(e){}},l=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,l.prototype,{constructor:l,VERSION:"3.4.0",newMenu:null,treeMenu:null,menuSearch:null,init:function(){var t=this,i=t.options,s=i.selector,n=i.newMenu,r=i.treeMenu,d=i.menuSearch,l=e(s.newMenu,t.$element),c=e(s.treeMenu,t.$element),u=e(s.menuSearch,t.$element);n.localData=n.localData||i.localData,r.localData=r.localData||i.localData,n.url=n.url||i.url,r.url=r.url||i.url;try{l.length>0&&(t.newMenu=e.isFunction(n.newMenu)?n.newMenu:l.udeskNewMenu(n).data("udeskNewMenu")),c.length>0&&(t.treeMenu=e.isFunction(r.treeMenu)?r.treeMenu:c.udeskTreeMenu(r).data("udeskTreeMenu"),d=e.extend(!0,d,{target:d.target||t.treeMenu}),t.menuSearch=e.isFunction(d.menuSearch)?d.menuSearch:u.udeskMenuSearch(d).data("udeskMenuSearch"))}catch(t){return console.log(t),null}return a(t),o(t),e.isFunction(i.onInit)&&i.onInit(t.$element),t},refreshAllSysMenu:function(t){var i=this.options;return this.newMenu&&this.newMenu.refreshMenu(),this.treeMenu&&this.treeMenu.refreshMenu(),e.isFunction(t)&&t(this.$element),e.isFunction(i.onRefreshAll)&&i.onRefreshAll(this.$element),this},slideOpen:function(t){var s=this,n=s.options,a=n.selector,o=s.$element,r=n.slideCss,d=e(a.mainSidebar),l=e(a.reducedSidebar),c=e(a.content),u=d.data(n.slideFlag),h=i.documentElement.clientWidth;return 1==u||"true"==u||"opening"==u?(e.isFunction(t)&&t(o),e.isFunction(n.onSlideOpen)&&n.onSlideOpen(o),s):(d.data(n.slideFlag,"opening"),c.stop(!0).animate(h<n.toggleWidth?r[1]:r[2],{queue:!1,duration:n.slideSpeed,easing:n.slideEasing}),l.addClass("hidden"),d.stop(!0).animate(r[1],{queue:!1,duration:n.slideSpeed,easing:n.slideEasing,complete:function(i){d.data(n.slideFlag,!0),e.isFunction(t)&&t(o),e.isFunction(n.onSlideOpen)&&n.onSlideOpen(o)}}),this)},slideClose:function(t){var i=this,s=i.options,n=i.options.selector,a=i.$element,o=s.slideCss,r=e(n.mainSidebar),d=(e(n.reducedSidebar),e(n.content)),l=r.data(s.slideFlag);return 0==l||"false"==l||"closing"==l?(e.isFunction(t)&&t(a),e.isFunction(s.onSlideClose)&&s.onSlideClose(a),i):(r.data(s.slideFlag,"closing"),d.stop(!0).animate(o[1],{queue:!1,duration:s.slideSpeed,easing:s.slideEasing,complete:function(){}}),r.stop(!0).animate(o[0],{queue:!1,duration:s.slideSpeed,easing:s.slideEasing,complete:function(){r.data(s.slideFlag,!1),e.isFunction(t)&&t(a),e.isFunction(s.onSlideClose)&&s.onSlideClose(a)}}),this)},slideToggle:function(t){var i=this,n=i.options,a=(i.options.selector,i.$element),o=a,r=o.data(n.slideFlag);return 1==r||"true"==r||s==r?i.slideClose(function(){e.isFunction(t)&&t(a),e.isFunction(n.onSlideToggle)&&n.onSlideToggle(a)}):i.slideOpen(function(){e.isFunction(t)&&t(a),e.isFunction(n.onSlideToggle)&&n.onSlideToggle(a)}),this}}),e.fn.udeskSidebar=function(t){var i=e.extend(!0,{},e.fn.udeskSidebar.defaults,t);return this.each(function(){var t=e(this);e(this).data("udeskSidebar")||t.data("udeskSidebar",new e.fn.udeskSidebar.constructor(t,i))})},e.fn.udeskSidebar.defaults=d,e.fn.udeskSidebar.constructor=l})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";function n(t,i){var s=i.templates,n=i.selector;t.wrap(s.container(n));var o=t.parent();t.after(s.treeView(n)),i.showButton&&t.after(s.showButton(n));var r=e.extend(!0,{},i,{dragAndDrop:!0}),d=t.siblings(n.treeviewStyle).kendoTreeView(r).data("kendoTreeView");return d.bind("select",function(t){var s=this.dataItem(t.node);e(n.treeviewStyle,o).hide(),e(n.inputStyle,o).val(s.text),e(n.treeviewStyle,o).hide(),e(n.buttonStyle,o).val(n.showItems),e.isFunction(i.onSelect)&&i.onSelect(d)}),d.bind("change",i.onTreeViewChange),d.bind("check",i.onTreeViewCheck),d.bind("collapse",i.onTreeViewCollapse),d.bind("dataBound",i.onTreeViewDataBound),d.bind("drag",i.onTreeViewDrag),d.bind("dragend",i.onTreeViewDragend),d.bind("dragstart",i.onTreeViewDragstart),d.bind("drop",i.onTreeViewDrop),d.bind("expand",i.onTreeViewExpand),d.bind("navigate",i.onTreeViewNavigate),d.bind("select",i.onTreeViewSelect),a(t,i,o),d}function a(t,i,s){var n=i.templates,a=i.selector,o=t.siblings(a.treeviewStyle).data("kendoTreeView");t.on("keyup",function(){if(e(a.treeviewStyle+a.liItemStyle,s).show(),e(a.spanIn2Highlight,s).each(function(){e(this).parent().text(e(this).parent().text())}),""===e.trim(e(this).val()))return void o.select().find(a.spanKStateSelected).removeClass(a.kStateSelected);var r=this.value.toUpperCase(),d=r.length;e(a.treeviewStyle+a.spanKIn,s).each(function(t){for(var i,s=e(this).text(),l="",c=0;(i=s.toUpperCase().indexOf(r,c))>=0;){var u={skipText:s.substring(c,i),highlightText:s.substr(i,d)};l+=n.highlightSpan(u),c=i+d}c>0&&(l+=s.substring(c),e(this).html(l),e(this).parentsUntil(a.kTreeViewStyle).filter(a.kItemStyle).each(function(t,i){o.expand(e(this)),e(this).data("SearchTerm",r)}))}),e(a.treeviewStyle+a.liKItemNotHasHighlight,s).hide(),e.isFunction(i.onKeyup)&&i.onKeyup(e(t))}),t.on("blur",function(){e.isFunction(i.onBlur)&&i.onBlur(t)}),t.on("focus",function(){t.siblings(a.treeviewStyle).show(),t.siblings(a.buttonStyle).val(a.packItems),t.siblings(a.inputStyle).keyup(),e.isFunction(i.onFocus)&&i.onFocus(t)}),t.siblings(a.buttonStyle).on("click",function(){t.siblings(a.treeviewStyle).is(":hidden")?t.siblings(a.buttonStyle).val(a.packItems):t.siblings(a.buttonStyle).val(a.showItems),t.siblings(a.treeviewStyle).toggle(),e.isFunction(i.onClick)&&i.onClick(t)})}var o=(t.udesk=t.udesk||{},"udeskDropDownTree"),r={dataSource:null,showSelected:!1,showButton:!0,templates:{container:kendo.template?kendo.template('<div class="u-ddtree-wrapper"><div id="#=containerIdx#" style="white-space: nowrap;"></div></div>'):s,treeView:kendo.template?kendo.template('<div class="u-ddtree-view" id="#=treeviewId#"></div>'):s,showButton:kendo.template?kendo.template('<input type="button" class="u-ddtree-btn" id="#=showButtonIdx#" value="#=showItems#">'):s,highlightSpan:kendo.template?kendo.template('#=skipText#<span class="highlight">#=highlightText#</span>'):s},selector:{containerIdx:null,treeviewId:null,showButtonIdx:null,showItems:"展开/搜索",packItems:"收起列表",treeviewStyle:".u-ddtree-view",inputStyle:".u-ddtree-input",buttonStyle:".u-ddtree-btn",liItemStyle:"li.k-item",spanIn2Highlight:"span.k-in > span.highlight",spanKStateSelected:"span.k-state-selected",kStateSelected:"k-state-selected",spanKIn:"span.k-in",highlightSpan:'<span class="highlight">',spanTab:"</span>",kTreeViewStyle:".k-treeview",kItemStyle:".k-item",liKItemNotHasHighlight:' li.k-item:not(:has(".highlight"))'},onInit:function(e){},onFocus:function(e){},onBlur:function(e){},onClick:function(e){},onKeyup:function(e){},onSelect:function(e){},onTreeViewChange:function(e){},onTreeViewCheck:function(e){},onTreeViewCollapse:function(e){},onTreeViewDataBound:function(e){},onTreeViewDrag:function(e){},onTreeViewDragend:function(e){},onTreeViewDragstart:function(e){},onTreeViewDrop:function(e){},onTreeViewExpand:function(e){},onTreeViewNavigate:function(e){},onTreeViewSelect:function(e){}},d=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,d.prototype,{constructor:d,VERSION:"3.4.0",dataSource:function(){return this.options.dataSource},treeView:null,init:function(){var t=this,i=t.options;return t.treeView=n(t.$element,i),e.isFunction(i.onInit)&&i.onInit(t.$element),t},treeViewAppend:function(e){var t=this;return t.options,t.treeView.append(e)},treeViewCollapse:function(e){var t=this;return t.options,t.treeView.collapse(e)},treeViewDataItem:function(e){var t=this;return t.options,t.treeView.dataItem(e)},treeViewDestroy:function(){var e=this;return e.options,e.treeView.destroy()},treeViewDetach:function(e){var t=this;return t.options,t.treeView.detach(e)},treeViewEnable:function(e){var t=this;return t.options,t.treeView.enable(e)},treeViewExpand:function(e){var t=this;return t.options,t.treeView.expand(e)},treeViewExpandPath:function(e){var t=this;return t.options,t.treeView.expandPath(e)},treeViewExpandTo:function(e){var t=this;return t.options,t.treeView.expandTo(e)},treeViewFindByText:function(e){var t=this;return t.options,t.treeView.findByText(e)},treeViewFindByUid:function(e){var t=this;return t.options,t.treeView.findByUid(e)},treeViewInsertAfter:function(e,t){var i=this;return i.options,i.treeView.insertAfter(e,t)},treeViewInsertBefore:function(e,t){var i=this;return i.options,i.treeView.insertBefore(e,t)},treeViewParent:function(e){var t=this;return t.options,t.treeView.parent(e)},treeViewRemove:function(e){var t=this;return t.options,t.treeView.remove(e)},treeViewSelect:function(e){var t=this;return t.options,t.treeView.select(e)},treeViewSetDataSource:function(e){var t=this;return t.options,t.treeView.setDataSource(e)},treeViewText:function(e,t){var i=this;return i.options,i.treeView.text(e,t)},treeViewToggle:function(e){var t=this;return t.options,t.treeView.toggle(e)},treeViewUpdateIndeterminate:function(){var e=this;return e.options,e.treeView.updateIndeterminate()}}),e.fn[o]=function(t){var i=e.extend(!0,{},e.fn[o].defaults,t);return this.each(function(){var t=e(this);e(this).data(o)||t.data(o,new e.fn[o].constructor(t,i))})},e.fn[o].defaults=r,e.fn[o].constructor=d})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";var n="udeskCapitalizedTextBox",a={max:1e15,min:0,step:1,format:"￥#.00",closeOnBlur:!0,showOnInit:!0,showOnFocus:!0,overRanging:"数值超出限制",reg:{reg:/[\u3002|\uff01|\uff1f|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|a-z|A-Z|\u4e00-\u9fa5]/},digit:{tenth:"角",percentile:"分",zero:"零",one:"壹",two:"贰",three:"叁",four:"肆",five:"伍",six:"陆",seven:"柒",eight:"捌",nine:"玖",ten:"拾",yuan:"元",hunderd:"佰",thousand:"仟",tenthousand:"万",hundredmillion:"亿",debt:"欠",wholenumber:"整",zeroelement:"零元",nomarks:"零分",zerointegral:"零元整",billion:"万亿"},selector:{capBoxInput:".u-capbox-input",capBoxTip:".u-capbox-tip"},templates:{tip:'<span class="u-capbox-tip" style="display:none"></span>'},onChange:function(){},OnSpin:function(){}},o=function(t){var i=t,s=i.numericTextBox,n=i.options,a=i.options.selector,o=function(e){var t=n.digit,i=[t.tenth,t.percentile],s=[t.zero,t.one,t.two,t.three,t.four,t.five,t.six,t.seven,t.eight,t.nine],a=[["",t.tenthousand,t.hundredmillion,t.billion],["",t.ten,t.hunderd,t.thousand]],o=e<0?t.debt:"";-1!=e.toString().indexOf("-")&&(e=Math.abs(e));var r=e.toString();if(r>=n.max)return"";var d="",l="",c=r.split(".");r.indexOf(".")>0?c.length>1&&(d=c[1].substr(0,2),l=c[0]):-1==r.indexOf(".")&&(l=c[0]);var u="",h="",p="";if(""!=d)for(var f=d.length,_=0;_<f;_++){var m=d.substr(_,1);0!=m&&(u+=s[Number(m)]+i[_])}if(u=u||t.wholenumber,h=h||t.yuan,e=Math.floor(e),parseInt(l,10)>=0)for(var g=0,v=l.length,_=0;_<v;_++){var w=l.substr(_,1),b=v-_-1,y=b/4,x=b%4;"0"==w?(g++,"0"==l.substr(0,1)&&(p+=s[parseInt(w)]+a[1][x])):(g>0&&(p+=s[0]),g=0,p+=s[parseInt(w)]+a[1][x]),0==x&&g<4&&(p+=a[0][y])}return o+p+h+u},r=function(e){var t=n.digit,i=n.reg,s="";if(""!==e&&null!=e&&"-"!=e&&"."!=e){if(i.reg.test(e))return s=t.zeroelement;var a=e.toString();if(a.indexOf(".")<0&&(s=o(a)),a.indexOf(".")>0){var r=a.split(".");s=1==r[1].length?o(a)+t.nomarks:o((r[1].length,a))}return s.indexOf(t.yuan)<0&&(s=n.overRanging),s}};if(s.bind("spin",function(){var t=this.value(),s=r(t);e(a.capBoxTip,i.parentBox).text(s)}),s.bind("change",function(){var t=this.value(),s=r(t);e(a.capBoxTip,i.parentBox).text(s)}),i.$element.on("focus",function(){var t=e(this).val(),s=r(t);e(a.capBoxTip,i.parentBox).show(),e(a.capBoxTip,i.parentBox).text(s)}),n.showOnInit){var d=i.$element.data("kendoNumericTextBox"),l=d.value();e(a.capBoxTip,i.parentBox).show();var l=o(l);e(a.capBoxTip,i.parentBox).text(l)}return i.$element.on("keyup",function(){var t=e(this).val(),s=r(t);""==t?e(a.capBoxTip,i.parentBox).empty():e(a.capBoxTip,i.parentBox).text(s)}),i},r=function(e,t){return this.$element=e,this.options=t,this.init(),this};e.extend(!0,r.prototype,{constructor:r,VERSION:"3.4.0",numericTextBox:null,parentBox:null,init:function(){var t=this,i=t.options,s=(t.$element,t.options.selector);try{t.numericTextBox=t.$element.kendoNumericTextBox(i).data("kendoNumericTextBox")}catch(t){return console.error(t),null}return t.$element.addClass(i.selector.capBoxInput.substr(1)),t.parentBox=e(t.$element).parents(".k-numerictextbox"),t.parentBox.append(t.options.templates.tip),i.showOnFocus&&t.numericTextBox.focus(),i.closeOnBlur&&t.$element.blur(function(){e(s.capBoxTip,t.parentBox).hide()}),o(t),t},focus:function(){return this.numericTextBox.focus()},enable:function(e){return this.numericTextBox.enable(e)},readOnly:function(e){return this.numericTextBox.readonly(e)},max:function(e){return this.numericTextBox.max(e)},min:function(e){return this.numericTextBox.min(e)},step:function(e){return this.numericTextBox.step(e)},value:function(e){return this.numericTextBox.value(e)},destroy:function(){return this.numericTextBox.destroy()},change:function(){var t=this,i=t.options;if(e.isFunction(i.onChange))return i.onChange(t.$element),t},spin:function(){var t=this,i=t.options;if(e.isFunction(i.onSpin))return i.onSpin(t.$element),t}}),e.fn[n]=function(t){var i=e.extend(!0,{},e.fn[n].defaults,t);return this.each(function(){var t=e(this);e(this).data(n)||t.data(n,new e.fn[n].constructor(t,i))})},e.fn[n].defaults=a,e.fn[n].constructor=r})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";var n="udeskStaffSelect",a={srcTree:{dataSource:{transport:{read:{dataType:"json",cache:!1}},schema:{model:{id:"id",children:"items",fields:{description:"description",text:"text",checked:"checked",type:"type"}}}},dragAndDrop:!0,loadOnDemand:!1,checkboxes:{checkChildren:!0,name:"checkedItems",template:'<input type="checkbox" class="k-checkbox" id="#= item.uid #" name="checkedFiles[#= item.id #]" #= item.checked ? "checked" : ""#><label class="k-checkbox-label" for="#=item.uid#"></label>'},template:function(e){var t=e.item,i="user"==t.type.toLowerCase()?"fa-user":"fa-sitemap";return kendo.format('<span title="{0}"><i class="k-sprite fa {1}"></i>{2}</span>',t.description,i,t.text)},animation:{expand:{effects:"fadeIn expandVertical"}},dataTextField:"text",messages:{loading:"载入中，请稍后...",requestFailed:"数据请求失败！",retry:"数据请求失败，请重试..."},change:function(e){},check:function(e){},collapse:function(e){},dataBound:function(e){},drag:function(e){},drop:function(e){},dragend:function(e){},dragstart:function(e){},expand:function(e){},navigate:function(e){},select:function(e){}},dstTree:{dataSource:{schema:{model:{id:"id",children:"items",fields:{description:"description",text:"text",checked:"checked",type:"type"}}}},dragAndDrop:!0,checkboxes:{checkChildren:!0,name:"checkedItems",template:'<input type="checkbox" class="k-checkbox" id="#= item.uid #" name="checkedFiles[#= item.id #]" #= item.checked ? "checked" : ""#><label class="k-checkbox-label" for="#=item.uid#"></label>'},dataTextField:"text",messages:{loading:"载入中，请稍后...",requestFailed:"数据请求失败！",retry:"数据请求失败，请重试..."},change:function(e){},check:function(e){},collapse:function(e){},dataBound:function(e){},drag:function(e){},drop:function(e){},dragend:function(e){},dragstart:function(e){},expand:function(e){},navigate:function(e){},select:function(e){}},addLeafNodeOnly:!0,addChildren:!0,addOnCheck:!1,removeOnCheck:!1,seprator:", ",dataTextField:"text",dataValueField:"id",selector:{dialog:".u-select-dialog",srcView:".src-view",dstView:".dst-view",searchInput:".u-search",searchBtn:".u-search-btn",select:".sel",remove:".rm",confirm:".u-confirm",cancel:".u-cancel",selAllSrc:".sel-all-src",selAllDst:".sel-all-dst"},wrapper:'<div class="udeskModal"></div>',templates:{modal:'<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="udeskModalLabel" aria-hidden="true"><div class="modal-dialog modal-lg u-select-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">{{=it.title}}</h4></div><div class="modal-body">{{=it.search}}<div class="form-group clearfix"><div class="col-xs-12"><button type="button" class="btn btn-default sel-all-src">{{=it.selAllSrc}}</button><button type="button" class="btn btn-default pull-right sel-all-dst">{{=it.selAllDst}}</button></div></div><div class="form-group" style="white-space: nowrap;"><div class="src-view"></div><div class="handle-view"><div class="handle-group"><span class="btn btn-theme sel">{{=it.select}}</span><span class="btn btn-default rm">{{=it.remove}}</span></div></div><div class="dst-view"></div></div></div>\x3c!-- END OF .modal-body  --\x3e<div class="modal-footer"><button type="button" class="btn btn-theme u-confirm" data-dismiss="modal">{{=it.confirm}}</button><button type="button" class="btn btn-default u-cancel"  data-dismiss="modal">{{=it.cancel}}</button></div>\x3c!-- END OF .modal-footer  --\x3e</div></div></div>',search:'<div class="form-group clearfix"><div class="col-xs-12"> <span class="k-textbox k-space-right"><input class="form-control u-search" placeholder="请输入名称" style="height:27px;"><a class="k-icon k-i-search u-search-btn"></a></span></div></div>',title:'<i class="fa fa-user"></i><b> 请选择人员 </b>',select:'<i class="fa fa-angle-double-right"></i>',remove:'<i class="fa fa-angle-double-left"></i>',selAllSrc:'<i class="fa fa-check"></i>全选',deSelAllSrc:'<i class="fa fa-close" style="padding-right: 0px;"></i>全不选',selAllDst:'<i class="fa fa-check"></i>全选',deSelAllDst:'<i class="fa fa-close" style="padding-right: 0px;"></i>全不选',confirm:"确定",cancel:"取消"},modal:{backdrop:!0,keyboard:!0,show:!0,onShow:function(e){},onShown:function(e){},onHide:function(e){},onHidden:function(e){}},search:null,onInit:function(e){},onClick:function(e){},onSelAllSrcClick:function(e){},onSelAllDstClick:function(e){},onSearchInputKeyUp:function(e){},onSelectClick:function(e){},onRemoveClick:function(e){},onConfirmClick:function(e){},onCancelClick:function(e){}},o=function(e,t){return this.$element=e,this.options=t,this.init()};e.extend(!0,o.prototype,{constructor:o,VERSION:"3.4.0",isInitialized:!1,isSrcAllSelected:!1,isDstAllSelected:!1,valueArray:null,$wrapper:null,$dialog:null,$selAllSrc:null,$selAllDst:null,$searchInput:null,$searchBtn:null,srcTreeView:null,dstTreeView:null,searchDS:null,init:function(){var t=this,i=t.options,s=t.options.selector;t.$wrapper=e(i.wrapper).appendTo("body");var n=udesk.template(i.templates.modal)(i.templates);return n&&(t.$dialog=t.$wrapper.append(n).children().last()),t.$selAllSrc=e(s.selAllSrc,t.$dialog),t.$selAllDst=e(s.selAllDst,t.$dialog),t.$searchInput=e(s.searchInput,t.$dialog),t.$searchBtn=e(s.searchBtn,t.$dialog),t._bindAction(),e.isFunction(i.onInit)&&i.onInit(t.$element),t},value:function(){return this.valueArray||[]},_addCheckedNode:function(e,t){return e&&e.checked?(this.options.addLeafNodeOnly&&e.hasChildren||(t[e.id]=t[e.id]||e,this.options.addOnCheck&&this._appendNode(e,this.dstTreeView)),t):t},_removeCheckedNode:function(e,t){return e?(delete t[e.id],t):t},_handleCheckedList:function(e,t,i){if(!e)return t;var s,n=e;for(n.id&&(n=new Array,n.push(e)),s=0;s<n.length;s++)i?this._addCheckedNode(n[s],t):this._removeCheckedNode(n[s],t),n[s].hasChildren&&this._handleCheckedList(n[s].children.view(),t,i);return t},_appendNodes:function(e,t){if(e&&t){var i,s=new Array;for(i in e)if(!t.dataSource.get(i)){var n=e[i].toJSON();n.checked=n.selected=!1,s.push(n)}s.length&&t.append(s)}},_appendNode:function(e,t){if(e&&e.id&&t&&!t.dataSource.get(e.id)){var i=e.toJSON();i.checked=i.selected=!1,t.append(i)}},_detachNodes:function(e,t){if(e&&t){var i;for(i in e)this._detachNode(i,t)}},_detachNode:function(e,t){var i=t.dataSource;e&&t&&i&&i.get(e)&&i.remove(i.get(e))},_bindAction:function(){function t(t){var i=t,s=i.options,n=s.selector,a=i.srcTreeView,o=i.dstTreeView;a.bind("drag",function(t){if("denied"!=t.statusClass){var i=e(t.dropTarget),s=i.hasClass(n.dstView.split(".")[1])||i.parentsUntil(n.dialog,n.dstView).length||!1;return t.setStatusClass(s?"k-add":"k-denied")}}),a.bind("drop",function(t){var s=e(t.dropTarget);if(!s.hasClass(n.dstView.split(".")[1])&&!s.parentsUntil(n.dialog,n.dstView).length)return t.setValid(!1);t.preventDefault(),i._appendNode(t.sender.dataItem(t.sourceNode),o)}),a.bind("check",function(e){var t=e.sender,s=t.dataItem(e.node);t.checkedNodes=t.checkedNodes||{},i._handleCheckedList(s,t.checkedNodes,s.checked)}),a.bind("select",function(e){var t=e.sender,s=t.dataItem(e.node);t.checkedNodes=t.checkedNodes||{},s.set("checked",!0),i._handleCheckedList(s,t.checkedNodes,!0)}),o.bind("drag",function(t){if("denied"!=t.statusClass){var i=e(t.dropTarget),s=this.dataItem(t.sourceNode),a=this.dataItem(t.dropTarget);return i.hasClass(n.srcView.split(".")[1])||i.parentsUntil(n.dialog,n.srcView).length?t.setStatusClass("k-add"):a&&s.level()==a.level()&&"add"!=t.statusClass?void 0:t.setStatusClass("k-denied")}}),o.bind("drop",function(t){var s=e(t.dropTarget);if(s.hasClass(n.srcView.split(".")[1])||s.parentsUntil(n.dialog,n.srcView).length)return t.preventDefault(),i._appendNode(t.sender.dataItem(t.sourceNode),o),i._detachNode(o.dataItem(t.sourceNode).id,o)}),o.bind("check",function(e){var t=e.sender,n=t.dataItem(e.node);t.checkedNodes=t.checkedNodes||{},s.removeOnCheck?n.checked&&i._detachNode(n.id,t):i._handleCheckedList(n,t.checkedNodes,n.checked)}),o.bind("select",function(e){var t=e.sender,n=t.dataItem(e.node);t.checkedNodes=t.checkedNodes||{},s.removeOnCheck?(i._detachNode(n.id,t),e.preventDefault(),i._handleCheckedList(n,t.checkedNodes,!1)):(n.set("checked",!0),i._handleCheckedList(n,t.checkedNodes,!0))}),e(n.searchInput,i.$dialog).on("keyup",function(){s.search?(i.searchDS=e.extend(!0,{},s.srcTree.dataSource,s.search),a.setDataSource(new kendo.data.HierarchicalDataSource(e.extend(!0,i.searchDS,{transport:{inputText:e(this).val()}})))):i._filter(a.dataSource,this.value.toLowerCase()),e.isFunction(s.onSearchInputKeyUp)&&s.onSearchInputKeyUp(i)}),e(n.select,i.$dialog).on("click",function(t){i._appendNodes(a.checkedNodes,o),e.isFunction(s.onSelectClick)&&s.onSelectClick(i)}),e(n.remove,i.$dialog).on("click",function(t){i._detachNodes(o.checkedNodes,o),o.checkedNodes={},!o.dataSource.data().length&&i.isDstAllSelected&&i.$selAllDst.click(),e.isFunction(s.onRemoveClick)&&s.onRemoveClick(i)}),e(n.confirm,i.$dialog).on("click",function(t){var n,a=o.dataSource.data(),r="";for(i.valueArray&&delete i.valueArray,i.valueArray=new Array,n=0;n<a.length;n++)r+=a[n][s.dataTextField]+s.seprator,i.valueArray.push(a[n][s.dataValueField]);i.$element.val(r),e.isFunction(s.onConfirmClick)&&s.onConfirmClick(i)}),e(n.cancel,i.$dialog).on("click",function(t){e.isFunction(s.onCancelClick)&&s.onCancelClick(i)})}var i=this,s=i.options,n=i.options.selector;return i.srcTreeView,i.dstTreeView,i.$element.on("click",function(t){e.isFunction(s.onClick)&&s.onClick(i),i.$dialog.modal(s.modal)}),i.$dialog.on("show.bs.modal",function(){if(!i.isInitialized){if(!e.fn.kendoTreeView)return udesk.error("kendoTreeView is not defined."),null;var a=e.extend(!0,{},s.srcTree,{dataSource:new kendo.data.HierarchicalDataSource(s.srcTree.dataSource),dataBound:function(t){var n=t.sender;n.checkedNodes=n.checkedNodes||{},i._handleCheckedList(n.dataSource.view(),n.checkedNodes,!0),e.isFunction(s.srcTree.dataBound)&&s.srcTree.dataBound(t)}}),o=e.extend(!0,{},s.dstTree,{dataSource:new kendo.data.HierarchicalDataSource(s.dstTree.dataSource),dataBound:function(t){var n=t.sender;n.checkedNodes=n.checkedNodes||{},i._handleCheckedList(n.dataSource.view(),n.checkedNodes,!0),e.isFunction(s.srcTree.dataBound)&&s.srcTree.dataBound(t)}});i.srcTreeView=e(n.srcView,i.$dialog).kendoTreeView(a).data("kendoTreeView"),i.dstTreeView=e(n.dstView,i.$dialog).kendoTreeView(o).data("kendoTreeView"),t(i),i.isInitialized=!0}e.isFunction(s.modal.onShow)&&s.modal.onShow(i.$dialog)}),i.$dialog.on("shown.bs.modal",function(){e.isFunction(s.modal.onShown)&&s.modal.onShown(i.$dialog)}),i.$dialog.on("hide.bs.modal",function(){e.isFunction(s.modal.onHide)&&s.modal.onHide(i.$dialog)}),i.$dialog.on("hidden.bs.modal",function(){e.isFunction(s.modal.onHidden)&&s.modal.onHidden(i.$dialog)}),i.$selAllSrc.on("click",function(){i.isSrcAllSelected=!i.isSrcAllSelected,i.$selAllSrc.html(i.isSrcAllSelected?s.templates.deSelAllSrc:s.templates.selAllSrc);var t,n=i.srcTreeView.dataSource.data();for(t=0;t<n.length;t++)n[t].set("checked",i.isSrcAllSelected);i._handleCheckedList(n,i.srcTreeView.checkedNodes,i.isSrcAllSelected),e.isFunction(s.onSelAllSrcClick)&&s.onSelAllSrcClick(i)}),i.$selAllDst.on("click",function(){i.isDstAllSelected=!i.isDstAllSelected,i.$selAllDst.html(i.isDstAllSelected?s.templates.deSelAllDst:s.templates.selAllDst);var t,n=i.dstTreeView.dataSource.data();for(t=0;t<n.length;t++)n[t].set("checked",i.isDstAllSelected);i._handleCheckedList(n,i.dstTreeView.checkedNodes||{},i.isDstAllSelected),e.isFunction(s.onSelAllDstClick)&&s.onSelAllDstClick(i)}),i},_filter:function(e,t){for(var i=!1,s=e instanceof kendo.data.HierarchicalDataSource&&e.data(),n=0;n<s.length;n++){var a=s[n],o=a.text.toLowerCase(),r=!0===t||""===t||o.indexOf(t)>=0,d=this._filter(a.children,r||t);i=i||d||r,a.hidden=!r&&!d}return s&&e.filter({field:"hidden",operator:"neq",value:!0}),i}}),e.fn[n]=function(t){var i=e.extend(!0,{},e.fn[n].defaults,t);return this.each(function(){var t=e(this);e(this).data(n)||t.data(n,new e.fn[n].constructor(t,i))})},e.fn[n].defaults=a,e.fn[n].constructor=o})},function(e,t,i){var s,n;!function(a){s=[i(0)],void 0!==(n=function(e){return a(e,window,document)}.apply(t,s))&&(e.exports=n)}(function(e,t,i,s){"use strict";var n="udeskCapitalsTip",a={autoHide:!1,animation:{open:{effects:"fade:in",duration:200},close:{effects:"fade:out",duration:200}},callout:!1,content:"大写锁定已打开！",position:"bottom",showAfter:100,showOn:null,onInit:function(e){},onKeydown:function(e){},onKeyup:function(e){},onKeypress:function(e){},onFocus:function(e){},onBlur:function(e){},onCapsLock:function(e){},show:function(){},hide:function(){}},o=function(e,t){return this.$element=e,this.options=t,this.init()};e.extend(!0,o.prototype,{constructor:o,VERSION:"3.4.0",capsKey:null,tip:null,init:function(){var t=this,i=t.options;return t.options.selector,e.fn.kendoTooltip?(t.tip=t.$element.kendoTooltip(i).data("kendoTooltip"),t._bindAction(),e.isFunction(i.onInit)&&i.onInit(t.$element),t):s},value:function(e){return this.$element.val(e)},_bindAction:function(){var t=this,i=t.$element,s=t.options,n=t.tip;i.on("keyup",function(a){var o=a.keyCode,r=a.shiftKey;if(o>=65&&o<=90){var d=e(this).val(),l=(a.key||d[d.length-1]||"").charCodeAt(0);l>=65&&l<=90&&!r||l>=97&&l<=122&&r?(t.capsKey=!0,n.show(i)):(t.capsKey=!1,n.hide(i))}else 20==o&&(null!==t.capsKey&&((t.capsKey=!t.capsKey)?n.show(i):n.hide(i)),e.isFunction(s.onCapsLock)&&s.onCapsLock(t));e.isFunction(s.onKeyup)&&s.onKeyup(t)}),i.on("keydown",function(i){e.isFunction(s.onKeydown)&&s.onKeydown(t)}),i.on("keypress",function(i){e.isFunction(s.onKeypress)&&s.onKeypress(t)}),i.on("focus",function(i){e.isFunction(s.onFocus)&&s.onFocus(t)}),i.on("blur",function(i){t.capsKey=null,e.isFunction(s.onBlur)&&s.onBlur(t)})}}),e.fn[n]=function(t){var i=e.extend(!0,{},e.fn[n].defaults,t);return this.each(function(){var t=e(this);e(this).data(n)||t.data(n,new e.fn[n].constructor(t,i))})},e.fn[n].defaults=a,e.fn[n].constructor=o})}]);